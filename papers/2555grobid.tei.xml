<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /Users/atharsefid/Desktop/grobid-0.5.3/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.5.3" ident="GROBID" when="2020-09-29T02:46+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">A Comprehensive Study of DNS-over-HTTPS Downgrade Attack</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Qing</forename><surname>Huang</surname></persName>
							<email>qhuang6@uci.edu</email>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Deliang</forename><surname>Chang</surname></persName>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Zhou</forename><surname>Li</surname></persName>
							<email>zhou.li@uci.edu</email>
						</author>
						<author>
							<affiliation key="aff0">
								<orgName type="institution">University of California</orgName>
								<address>
									<settlement>Irvine</settlement>
								</address>
							</affiliation>
						</author>
						<author>
							<affiliation key="aff1">
								<orgName type="institution" key="instit1">Tsinghua University</orgName>
								<orgName type="institution" key="instit2">University of California</orgName>
								<address>
									<settlement>Irvine</settlement>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">A Comprehensive Study of DNS-over-HTTPS Downgrade Attack</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>DNS-over-HTTPS (DoH) is one major effort to protect DNS confidentiality and integrity, which has been deployed by most of the popular browsers. However, we found this effort could be tainted by the downgrade attack, which exposes the content of DNS communications to attackers like censors. Specifically, we examined 6 browsers with 4 attack vectors that are relevant to our attack model and found all combinations that lead to successful attacks. The fundamental reason is that all browsers enable Opportunistic Privacy profile by default, which allows DoH fall backs to DNS when DoH is not usable. However, it is still concerning that none of the browsers attempt to notify users when such a change happens and some browsers take a long time to recover to DoH. At the end of the paper, we propose some countermeasures and we call for discussions from the Internet community to revisit the standards and implementations about DoH and usage profiles.</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">Introduction</head><p>Domain name system (DNS) maps human-friendly stringtype domain names to machine-friendly numerical IP addresses, and it is a critical infrastructure of the Internet. Since the beginning of the Internet, DNS queries and responses are transmitted in plaintext according to <ref type="bibr">RFC 1035 [29]</ref>, which makes it very easy to be eavesdropped and manipulated. As a result, DNS is constantly under attack by network adversaries for surveillance and censorship <ref type="bibr" target="#b2">[3,</ref><ref type="bibr" target="#b17">18,</ref><ref type="bibr" target="#b25">26]</ref>.</p><p>To mitigate these threats and protect DNS's authenticity, confidentiality and integrity, several protocols aiming to transmit DNS packets in encrypted channel are proposed <ref type="bibr" target="#b13">[14,</ref><ref type="bibr" target="#b20">21,</ref><ref type="bibr" target="#b33">34]</ref>. Among those methods, DNS-over-HTTPS (DoH) <ref type="bibr" target="#b33">[34]</ref> is most promising, since it has already been implemented and integrated into most of the popular browsers like Google Chrome <ref type="bibr" target="#b16">[17]</ref> and <ref type="bibr">Firefox [30]</ref>. It is also offered as a service by large public resolvers like Cloudflare <ref type="bibr" target="#b11">[12]</ref>. In essence, DoH transmits DNS queries and responses between the stub resolvers and recursive resolvers via HTTPS protocol, as such any applications supporting HTTPS can issue DoH queries. Comparing to DNS-over-TLS (DoT) <ref type="bibr" target="#b20">[21]</ref> which requires a specialized stub resolver, the deployment overhead of DoH is much lower on the client-side.</p><p>To circumvent the protection offered by DoH, an active adversary might try to downgrade DoH to DNS and carry out the known DNS attacks. In fact, this is feasible as the usage profile RFC <ref type="bibr" target="#b35">[35]</ref> specifies that a stub resolver can choose Opportunistic Privacy profile, which allows DNS encryption to fall back to plaintext when the encrypted channel cannot be constructed. Still, there exists a gap between RFC and the implementations done by browser vendors, and this leads to several questions we are interested in: 1) What kind of attack vectors would cause the DoH to be downgraded? 2) What is the reaction of a browser under the downgrade attack? 3) What could be improved when facing downgrade attack?</p><p>In this study, we start by revisiting the process of DoH resolution and identify the attack surface that can be exploited for DoH downgrade. Then we tested 4 attack vectors, including DNS traffic interception, DNS cache poisoning, TCP traffic interception and TCP reset injection on 6 browsers supporting DoH. We have reported our findings to the browser vendors. Though none of the browser vendors replying to us consider that browsers vulnerable to DoH downgrade attacks as security bugs, we argue that their design could be improved, as a user is never notified when DoH fallback happens, and some browsers have very long recovery time. Our contributions are listed below:</p><p>• We perform the first study of downgrade attacks on DoH, by systematically enumerating the attack surface and examining the attack vectors.</p><p>• We evaluate the attacks in a realistic lab environment and found downgrade attack is not only feasible but succeeding against all browsers. We also found the reactions of browsers under attack are concerning.</p><p>• We discuss the possible countermeasures at the implementation and protocol level.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">Background</head><p>Domain name system (DNS). DNS translates domain names to their corresponding IP addresses. To be more specific, a software on client called stub resolver collects domain names requested by user applications. Then it sends DNS queries to recursive resolvers (RR). RR works as agent in DNS resolution. If the queried domain is not in its cache, it will send queries to authoritative name servers recursively. After RR receives the answer, it will send the answer back to the clients. So far, most of the DNS queries and responses are transmitted in plaintext, making it vulnerable to be manipulated. The DNS packets between stub resolver and recursive resolver are the major target for attackers, and previous research have shown that DNS queries from users could be used to track <ref type="bibr" target="#b18">[19,</ref><ref type="bibr" target="#b23">24]</ref> or censor <ref type="bibr" target="#b2">[3,</ref><ref type="bibr" target="#b25">26]</ref>  </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">DoH Downgrade Attacks</head><p>As TLS of HTTPS provides strong privacy and security protection, for the existing DNS attacks to succeed, a natural idea for the adversary is to downgrade DoH communication back to plaintext DNS. This is possible as the browser might try to achieve incremental deployment of DoH and avoid the disruption to users' normal communications when DoH is not usable. Below we first review the entire resolution process of DoH. After that, we describe the adversary model and available attack vectors that can be leveraged for DoH downgrade attacks.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1">Process of DoH Communication</head><p>Based on our analysis on popular browsers, DoH communication usually follows two phases as illustrated in <ref type="figure" target="#fig_0">Figure 1</ref>. Phase 1: URI Resolution. URI used in HTTP requests of DoH is defined by a URI template <ref type="bibr" target="#b33">[34]</ref>. Before DoH communication, a browser sends an unencrypted DNS request to resolve the URI and obtain the IP address of the DoH server (e.g., Google Public DNS and Cloudflare DNS). This phase is the same as the traditional DNS resolution process, which means any attacker capable of sniffing network traffic can view the plain text content in the DNS packet and tamper it. Phase 2: Connection &amp; Communication. The browser establishes a secure connection with the DoH resolver via TLS. After the connection is established, the DNS request will be encapsulated in an encrypted HTTPS packet through this transmission channel. The browser sends wire-format DNS messages under HTTPS GET or POST requests. An attacker able to compromise this phase could force the browser to fall back to plaintext DNS. Additionally, for browsers such as Chrome, a mapping table is used to convert the DNS resolver configured in the operating system into its equivalent DoH resolver URI before Phase 1. We call it Phase 0. Phase 0 is often hard-coded in the browser software, thus we do not consider this phase to be attacked. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2">Adversary Model</head><p>The attacker's goal is to force the encrypted DoH falling back to plaintext. In this paper, we assume two types of adversaries based on their capabilities of manipulating network packets. In-path Attackers. They can inspect the traffic of the victim, and have the ability to modify all packets from and towards the victim. A good example of in-path attackers is a network gateway, which is usually controlled by the network administrators of a company or the owner of a public WiFi. As such those parties have the capability to perform in-path attack.</p><p>Another example is an adversary in the local network. The attacker could perform ARP cache poisoning attack <ref type="bibr" target="#b31">[32]</ref> to redirect the victim traffic to the attacker's machine and act as a rogue middlebox. On-path Attackers. They can inspect the traffic of the victim and inject new packets. But unlike in-path attackers, they are unable to intercept or modify the passing-through packets. On-path attacker is weaker than in-path attackers. Because it consumes fewer resources for attack, it is widely deployed in middleboxes doing censorship <ref type="bibr" target="#b25">[26]</ref>, resulting in attacks that scale at ISP or country level. On the other hand, an attacker close to the victim, who shares the same LAN can also become a on-path attacker. Sniffing the traffic associated with the victim host is necessary but there are various ways to achieve this prerequisite, regardless of whether the network communication is encrypted or not. For example, for wireless communication encrypted under WPA/WPA2, if the EAPOL frame of the four-way handshake can be obtained at the beginning of the connection between the victim host and the AP (Access Point), the encryption provided by some WiFi devices can be breached <ref type="bibr" target="#b38">[38]</ref>. To hide the attacker's traits, the IP address can be spoofed with the original one in communication by the victim.</p><p>Putting the two attacks together, both attackers should have the ability to sniff the DoH traffic from client-side. The inpath attackers need the ability to intercept the packets of the victim, but the on-path attackers only need the ability to inject new packets.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.3">Attack Method</head><p>Based on the workflow of DoH described in Section 3.1, we use the following attacking vectors to achieve downgrade attacks. Here we present four concrete of attack methods that can be leveraged by in-path and on-path attackers, targeting different phases of DoH. Among those methods, DNS poisoning and TCP RST injection are known to be used in large-scale censorship <ref type="bibr" target="#b10">[11,</ref><ref type="bibr" target="#b25">26]</ref>. Assume a censor adds domain names listed in <ref type="table">Table 1</ref> to its censoring list, and use DNS poisoning to forge the response to an unreachable IP address. The user of those DoH server will be forced to use plaintext DNS thus are subject to further censorship and surveillance. This example shows that censors could easily achieve censorship on DoH with their existing facilities.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>DoH</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">Attack Evaluation</head><p>We implement our downgrade attack methods on DoH provided by different resolvers and browsers under different platforms. In this evaluation, we measured the behavior of various browsers that support DoH after being attacked, through network traffic analysis.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.1">Experiment Setup</head><p>Evaluation Settings. All of our evaluation tasks focus on the reaction of browser when they face different attack methods. We selected 6 browsers listed in   We evaluated the reactions of the 6 browsers when they are facing 4 different attack vectors, using the default settings (Opportunistic Privacy profile). We found that no matter what attack vector this browser is facing, as long as the attack has hindered the network traffic of the DoH service, the browser's response behavior will follow a pattern, which can be described by three attributes: Continuous Request Period (CRP), Interval Growth (IG) and Max Interval (MI). These three attributes reflect how browser reconnects to DoH servers when under attack and we illustrate this process at a high level in <ref type="figure" target="#fig_1">Figure 2</ref>. Due to the high complexity of browser codebase, we decide to treat them as blackbox, and run the testing scripts dynamically and log the values we observe for the three attributes. Below we explain them and highlight the interesting observations. Continuous Request Period (CRP). When the browser discovers that the connection fails, it will keep trying to send multiple reconnect requests within some period. We define this period as CRP. From an attacker's perspective, during CRP, they have to continue attacking the DoH traffic to ensure that the DoH can be successfully downgraded to plaintext DNS. On the other hand, the longer CRP is, the more difficult DoH service is to be attacked.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.2">Browser Reaction under Attack</head><p>Interval Growth (IG). Between every two consecutive CRP, there will be an interval during which the browser will not send any reconnect request related to DoH. Learning the exact interval, the attacker can pause the attack and sniff the plaintext DNS packets. What's more, by blocking the plaintext DNS queries to resolve the domain of DoH servers, the attacker is able to hold the user always following plaintext DNS. For the attacker, the longer the interval lasts, the stealthier the attack would be (i.e., less downgrade packets to be sent). We also found some browsers use the constant interval but some use interval of growing values, in a linear format. We use IG to differentiate these two cases.</p><p>Max Interval (MI). When the interval increases linearly, MI is the maximum value among all intervals. When the interval is constant, MI is the value of the interval.</p><p>Analysis of Browser Reactions. We examined the 4 attack methods on every browser through network packet analysis and found every combination leads to successful attack, though browsers react differently. According to the official documentation of each browser, browsers other than Firefox follow Chrome in how to configure DoH. Also our empirical analysis shows browsers other than Firefox behave in the identical way. Thus, we separate the browsers into "Firefox" and "Chrome+". The patterns are detailed in <ref type="table" target="#tab_2">Table 2 and  Table 3</ref>.</p><p>As a highlight, we found that none of the browsers prompt the user when DoH is downgraded to plaintext DNS. This is problematic as the user might have the perception that his/her DNS communication is still protected and continues to visit the sensitive websites. We also found the extra latency of visiting a website is not prominent when retrying DoH. Therefore, it becomes rather difficult for users to discover the attacks. Regarding CRP, we found the settings are quite diverse, with values ranging from 0.09 seconds to 36.52 seconds, and some even random 2 . In most situations, IG grows linearly and we speculate this is to reduce the unnecessary retries by the browser. While there are four combinations that result in MI of 50 to 65 seconds, we found for other combinations, the browser will not attempt to upgrade to DoH within 10 minutes, which is the maximum window we set to test each combination. Leveraging the measurement result of our study, an attacker can make flexible decision about how frequently to attack DoH, which attack method to use, based on his/her resources and victim's environment. <ref type="bibr" target="#b1">2</ref> Random in this case means the coefficient of variation (the ratio of standard deviation to the mean of CRP) is greater than 15%.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Attack</head><p>BType  </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.3">Feedback after Disclosure</head><p>We reported our observations via the vulnerability disclosure systems to the 6 browser vendors, together with our suggestions to better manage the threat of downgrade attacks. We have received responses from all of them except Microsoft Edge. Among the ones replied, none consider a fix is necessary in order to prevent DoH from being attacked. According to the reply from Firefox, that DoH is vulnerable under downgrade attacks is an expected feature of Opportunistic Privacy profile. Firefox believes this setting still protects the users against passive adversaries most of the time. Chrome claims that the issue is the "intended, designed, and documented behavior" of current Chrome DoH. In fact, Chrome uses plaintext DNS until a DoH resolver can be reliably connected and then upgrade all DNS communications to DoH in opportunistic mode. The communication falls back to plaintext DNS if any connection issue happens. For other browsers whose DoH implementation is provided entirely by the Chromium browser engine, the responses are similar or expected to be.</p><p>While given all browsers follow RFC 8310 <ref type="bibr" target="#b35">[35]</ref>, which has mentioned the possibility of attacks, it is unsurprising that none of the browsers will make a step to address our attacks. However, we are concerned that the user notification is deliberately ignored and none of the browser vendors plan to adopt it even though the integration into browser UI should incur moderate effort and overhead (e.g., using Notification API <ref type="bibr" target="#b27">[28,</ref><ref type="bibr" target="#b30">31]</ref>). We believe users should be put into the decision loop, so they can choose to avoid sensitive communications (e.g., visiting a controversial website) in a hostile environment when necessary. We have not found any justification for this design choice, but we speculate the reason is to reduce the likelihood that users are annoyed by the notifications. Still, we suggest a discussion among browser vendors and the Internet community should be initiated, because the bar of downgrade attack is relatively low.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5">Countermeasures</head><p>Revising DoH implementations. Our evaluation on browsers shows they all configure Opportunistic Privacy profile by default. While this setting avoids service disruption when DoH is unavailable, it is not suitable when a user is in an adversarial network environment. Though strict mode can be turned on for some browser settings, we found they are not easily identifiable to non-technical users, so we suggest the browser UIs be redesigned to make those options more explicit. In the meantime, the browsers that do not support strict mode should incorporate it as soon as possible. As described in Section 4.3, users should better be notified when DoH is disconnected.</p><p>To notice, user profiles are also the basic building blocks of DoT <ref type="bibr" target="#b35">[35]</ref>. Thus, we recommend future changes should be considered both DoH and DoT. Revising DoH protocols. We also suggest some components/stages of DoH can be revisited. URI Template <ref type="bibr" target="#b21">[22]</ref> is used to define the URI in DoH requests <ref type="bibr" target="#b33">[34]</ref>. In most cases, the hostname in URI needs to be resolved via plaintext DNS communications, or Phase 1. This makes DoH dependent on plaintext DNS, which could undermine its security benefit. In particular, we are concerned that a large-scale DoH downgrade attack might be possible, as the censor can leverage its existing middlebox to attack the DNS packet in Phase 1. Unfortunately, a practical fix without dampening the usability of DoH is not easy. (1) By always using IP address of DoH server, one can remove the dependency on DNS, and Firefox has offered this option, but the users have to set up both URI and IP address of a DoH resolver. (2) Another approach is to embed IP directly in URI template as the hostname, but it will prevent the authentication of DoH's identity that looks into SSL certificate of its hostname. Though IP addresses could be authenticated in a SSL certificate <ref type="bibr" target="#b14">[15,</ref><ref type="bibr" target="#b15">16]</ref>, it incurs extra configuration from the server owners, which is not yet broadly deployed. One major reason is the lack of clarity on how to authenticate IP's ownership at the webserver's level. Therefore, a new protocol or extension tailored to securing Phase 1 might be needed.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6">Related Work</head><p>DNS-over-HTTPS. Though DoH is installed as an RFC only two years ago <ref type="bibr" target="#b33">[34]</ref>, there have been a number of studies measuring its deployment, understanding its security implications and assessing its impact on the Internet ecosystem. For the measurement works, Lu et al. studied how DoH servers are distributed around the world, their reachability and performance, and the trend in user adoption <ref type="bibr" target="#b26">[27]</ref>. Böttger et al. measured the overhead of DoH based on statistical metrics like packet count and load time <ref type="bibr" target="#b7">[8]</ref> and <ref type="bibr">Hounsel et al. compared DoT, DoH and plaintext DNS [20]</ref>. <ref type="bibr">Deccio et al.</ref> measured the prevalence and characteristics of DoH servers and their TCP Fast Open (TFO) support, which is a feature to reduce the latency of DoH <ref type="bibr" target="#b12">[13]</ref>. Regarding security, traffic analysis was carried out to understand how likely DoH communications leak users' activities, e.g., whether visiting a website monitored by the adversary <ref type="bibr" target="#b8">[9,</ref><ref type="bibr" target="#b24">25,</ref><ref type="bibr" target="#b36">36]</ref>. Unfortunately, though protections like padding are applied to DoH packets, the studies show DoH is not resilient against such adversary. Regarding the societal impact, Borgolte et al. measured the effect of DoH on different operators, ISPs, regulations and policies <ref type="bibr" target="#b6">[7]</ref>. Our work investigates the security issues of DoH, but starting from a new angle (usage profile) not explored before.</p><p>Downgrade attacks. Downgrade attack forces a system to abandon its high-standard security protocol/setting and fall back to an older, weaker one. Downgrade attack has been found possible in TLS <ref type="bibr" target="#b1">[2]</ref>. For example, Logjam <ref type="bibr" target="#b0">[1]</ref> tricks the server to choose an "export-grade" Diffie-Hellman cipher suite. DROWN <ref type="bibr" target="#b3">[4]</ref>, on other hand, downgrades a TLS client to use SSLv2 during key exchange. TLS version could also be downgraded to an earlier one <ref type="bibr" target="#b4">[5]</ref>. Apart from TLS, downgrade attack is also explored in ARM hardware infrastructure <ref type="bibr" target="#b9">[10]</ref>, 5G <ref type="bibr" target="#b22">[23]</ref> and WPA3 certification <ref type="bibr" target="#b37">[37]</ref>. Though we carried out downgrade attacks against DoH, our goal is not to invent a new downgrade algorithm. Instead, we show the existing, relatively simple Denial-of-Service attack like TCP Reset can be used for downgrade attack against DoH, due to the usage profile settings of the browser.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="7">Conclusion</head><p>In this paper, we studied how browsers implement and configure DoH, especially how they react when DoH is interfered by an active adversary. We tested 4 different network attack vectors on DoH communications of 6 browsers and examined whether DoH can be downgraded to plaintext DNS. Our evaluation shows every combination of browser and attack vector leads to successful attack, and the attack is hard to be spotted, due to the lack of user notifications and relaxed reconnections. Though the issues we found are not explicit vulnerabilities on browsers, given that the browsers all follow the usage profiles RFC, we ask the Internet community to carefully examine the security implications of usage profiles. As temporary fixes, we proposed a few countermeasures that can be quickly applied, e.g., protecting the Phase 1 of DoH communication.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Figure 1 :</head><label>1</label><figDesc>Figure 1: DoH resolution process. Crosses represent the attack surface.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Figure 2 :</head><label>2</label><figDesc>Figure 2: Reconnection Process after Failed.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_2" validated="false"><head>Table 2 , which are all popular</head><label>2</label><figDesc></figDesc><table>Browser 

Config 
Profile 
BType Notif 

Chrome 84.0.4147.89 OS&amp;URI Opportunistic* Chrome+ No 
Firefox 76.0.1 
URI 
Opportunistic* Firefox 
No 
Edge 84.0.522.40 
OS 
Opportunistic Chrome+ No 
Brave 1.11.97 
OS 
Opportunistic Chrome+ No 
Opera 69.0.3686.77 
URI 
Opportunistic Chrome+ No 
Vivaldi 3.1.1929.458 
OS 
Opportunistic Chrome+ No 

</table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_3" validated="false"><head>Table 2 :</head><label>2</label><figDesc></figDesc><table>Browser DoH settings. "Config" indicates how to set 
DoH resolver's URI. "Profile" is the type of usage profile [35]. 
"BType" categorizes how a browser reacts when facing DoH 
Downgrade Attack. "Notif" is whether browser notifies its 
user when DoH is not usable. 

and supporting DoH. We set up the testing environment with 
three machines (Windows laptop and MAC laptop as victims 
and one Debian Linux machine as attacker) connecting to a 
wireless router (AT&amp;T WiFi Gateways). The attacker uses 
Wireshark 3.0.3 [33] to eavesdrop victim's traffic and Scapy-
2.4.3 [6] to craft attack packets. For in-path attack scenario, 
we change the router's firewall to block TCP/DNS packets 
related to DoH, or redirect user's traffic to attacker's machine 
by ARP spoofing and intercept victim's packets on it. We let 
the victim configure a DoH server first and then visit several 
random websites. Both Phase 1 (URI Resolution) and Phase 2 
(DoH Connection &amp; Communication) are tested. Though we 
examined different DoH servers listed in Table 1, we found 
whether the attack succeeds or not is independent of this factor. 
Therefore, we focus on the browser side for the remaining 
evaluation. 

Browser DoH Settings. Table 2 lists the detailed DoH set-
tings of each browser. Chrome, Firefox and Opera allow 
a user to specify DoH resolver's URI in security settings 
panel, while all others carry out Phase 0 to obtain the URI. 
Chrome uses DNS provider configured in operating system 
by default and all other browsers (Edge, Brave, Vivaldi) only 
use DNS provider configured in operating system as their 
DoH provider [17, 30]. More importantly, we found how 
browser reacts to downgrade attacks depends on the usage 
profiles that are enabled by default or by the user. Similar 
to DoT usage profiles described in RFC 8310 [35], there 
are two options: Strict Privacy profile and Opportunistic 
Privacy profile. For the first option, when DoH communi-
cations cannot be established, e.g., that the resolver cannot 
be connected through DoH, a "hard fail" will happen such 
that client will not consider plaintext DNS as the backup plan. 
For the second option, the client will attempt to establish the 
connection with the DNS resolver and use plaintext DNS 
after DoH communication fails. Apparently, when Oppor-
tunistic Privacy profile is enabled, downgrade attacks have 
potential to succeed. Interestingly, we found all browsers 
enable the latter one by default. Switching to strict mode 
is feasible, but not on every browser. For example, Firefox 
enables the strict mode when a user visits about:config 

page and change network.trr.mode to 3. Chrome on Win-
dows can be switched to the strict mode by explicitly select-
ing or inputting a custom provider. For other browsers like 
Brave and Chrome on MAC, we have not discovered the in-
terface. Also, there is a specific option in Firefox relevant 
to our attack: if the network.trr.bootstrap_address and 
network.trr.URI fields are set to the same DoH provider, 
Firefox can bypass the URI resolution phase and directly es-
tablish a DoH secure connection with the bootstrap address. 
As such, the attack methods against Phase 1 are ineffective in 
this case. 

</table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_5" validated="false"><head>Table 3 :</head><label>3</label><figDesc></figDesc><table>Reaction patterns under downgrade attack. N/A in 
MI means more than 10 minutes. All numbers are in seconds 
and are average values from multiple experiments. 

</table></figure>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Acknowledgement</head><p>We thank our reviewers and our shepherd Drew Springall for their great feedback.</p></div>
			</div>

			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<analytic>
		<title level="a" type="main">Imperfect forward secrecy: How Diffie-Hellman fails in practice</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">David</forename><surname>Adrian</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Karthikeyan</forename><surname>Bhargavan</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Zakir</forename><surname>Durumeric</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Pierrick</forename><surname>Gaudry</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Matthew</forename><surname>Green</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Alex</forename><surname>Halderman</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Nadia</forename><surname>Heninger</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Drew</forename><surname>Springall</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Emmanuel</forename><surname>Thomé</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Luke</forename><surname>Valenta</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the 22nd ACM SIGSAC Conference on Computer and Communications Security</title>
		<meeting>the 22nd ACM SIGSAC Conference on Computer and Communications Security</meeting>
		<imprint>
			<date type="published" when="2015" />
			<biblScope unit="page" from="5" to="17" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b1">
	<analytic>
		<title level="a" type="main">What&apos;s in a downgrade? a taxonomy of downgrade attacks in the TLS protocol and application protocols using TLS</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Eman</forename><surname>Salem Alashwali</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Kasper</forename><surname>Rasmussen</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">International Conference on Security and Privacy in Communication Systems</title>
		<imprint>
			<publisher>Springer</publisher>
			<date type="published" when="2018" />
			<biblScope unit="page" from="468" to="487" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Anonymous</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Gchq&amp;apos;s Quan-Tumtheory Hacking</forename><surname>The</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Tactics</surname></persName>
		</author>
		<ptr target="https://theintercept.com/document/2014/03/12/nsa-gchqs-quantumtheory-hacking-tactics/" />
		<imprint/>
	</monogr>
</biblStruct>

<biblStruct xml:id="b3">
	<analytic>
		<title level="a" type="main">DROWN: Breaking TLS using SSLv2</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Nimrod</forename><surname>Aviram</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Sebastian</forename><surname>Schinzel</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Juraj</forename><surname>Somorovsky</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Nadia</forename><surname>Heninger</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Maik</forename><surname>Dankel</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Jens</forename><surname>Steube</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Luke</forename><surname>Valenta</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">David</forename><surname>Adrian</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Alex</forename><surname>Halderman</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Viktor</forename><surname>Dukhovni</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">25th USENIX Security Symposium (USENIX Security 16)</title>
		<imprint>
			<date type="published" when="2016" />
			<biblScope unit="page" from="689" to="706" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b4">
	<analytic>
		<title level="a" type="main">Cédric Fournet, Matthew Green, Markulf Kohlweiss, and Santiago Zanella-Béguelin. Downgrade resilience in keyexchange protocols</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Karthikeyan</forename><surname>Bhargavan</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Christina</forename><surname>Brzuska</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">2016 IEEE Symposium on Security and Privacy (SP)</title>
		<imprint>
			<publisher>IEEE</publisher>
			<date type="published" when="2016" />
			<biblScope unit="page" from="506" to="525" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<monogr>
		<title level="m" type="main">Scapy: explore the net with new eyes</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Philippe</forename><surname>Biondi</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2005" />
		</imprint>
		<respStmt>
			<orgName>EADS Corporate Research Center</orgName>
		</respStmt>
	</monogr>
<note type="report_type">Technical report</note>
</biblStruct>

<biblStruct xml:id="b6">
	<monogr>
		<title level="m" type="main">How dns over https is reshaping privacy, performance, and policy in the internet ecosystem. Performance, and Policy in the Internet Ecosystem</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Kevin</forename><surname>Borgolte</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Tithi</forename><surname>Chattopadhyay</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Nick</forename><surname>Feamster</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Mihir</forename><surname>Kshirsagar</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Jordan</forename><surname>Holland</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Austin</forename><surname>Hounsel</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Paul</forename><surname>Schmitt</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2019-07-27" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b7">
	<analytic>
		<title level="a" type="main">An empirical study of the cost of DNS-over-HTTPS</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Timm</forename><surname>Böttger</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Felix</forename><surname>Cuadrado</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Gianni</forename><surname>Antichi</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Gareth</forename><surname>Eder Leão Fernandes</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Ignacio</forename><surname>Tyson</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Steve</forename><surname>Castro</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Uhlig</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the Internet Measurement Conference</title>
		<meeting>the Internet Measurement Conference</meeting>
		<imprint>
			<date type="published" when="2019" />
			<biblScope unit="page" from="15" to="21" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b8">
	<monogr>
		<title level="m" type="main">Padding ain&apos;t enough: Assessing the privacy guarantees of encrypted dns</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Jonas</forename><surname>Bushart</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Christian</forename><surname>Rossow</surname></persName>
		</author>
		<idno type="arXiv">arXiv:1907.01317</idno>
		<imprint>
			<date type="published" when="2019" />
		</imprint>
	</monogr>
<note type="report_type">arXiv preprint</note>
</biblStruct>

<biblStruct xml:id="b9">
	<monogr>
				<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Yue</forename><surname>Chen</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Yulong</forename><surname>Zhang</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Zhi</forename><surname>Wang</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Tao</forename><surname>Wei</surname></persName>
		</author>
		<idno type="arXiv">arXiv:1707.05082</idno>
		<title level="m">Downgrade attack on trustzone</title>
		<imprint>
			<date type="published" when="2017" />
		</imprint>
	</monogr>
<note type="report_type">arXiv preprint</note>
</biblStruct>

<biblStruct xml:id="b10">
	<analytic>
		<title level="a" type="main">Ignoring the great firewall of china</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Richard</forename><surname>Clayton</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Steven</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Robert Nm</forename><surname>Murdoch</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Watson</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">International Workshop on Privacy Enhancing Technologies</title>
		<imprint>
			<publisher>Springer</publisher>
			<date type="published" when="2006" />
			<biblScope unit="page" from="20" to="35" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b11">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Cloudflare</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Dns</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Https</surname></persName>
		</author>
		<ptr target="https://developers.cloudflare.com/1.1.1.1/dns-over-https" />
		<imprint>
			<date type="published" when="2020" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b12">
	<analytic>
		<title level="a" type="main">DNS privacy in practice and preparation</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Casey</forename><surname>Deccio</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Jacob</forename><surname>Davis</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the 15th International Conference on Emerging Networking Experiments And Technologies</title>
		<meeting>the 15th International Conference on Emerging Networking Experiments And Technologies</meeting>
		<imprint>
			<date type="published" when="2019" />
			<biblScope unit="page" from="138" to="143" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b13">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Frank</forename><surname>Denis</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Yecheng</forename><surname>Fu</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Dnscrypt</surname></persName>
		</author>
		<ptr target="https://www.dnscrypt.org/" />
		<imprint>
			<date type="published" when="2015" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b14">
	<monogr>
		<title level="m" type="main">Using an ip address in an ssl certificate</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Geocerts</surname></persName>
		</author>
		<ptr target="https://www.geocerts.com/support/ip-address-in-ssl-certificate" />
		<imprint/>
	</monogr>
</biblStruct>

<biblStruct xml:id="b15">
	<monogr>
		<title level="m" type="main">Securing a public ip address -ssl certificates</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Globalsign</surname></persName>
		</author>
		<ptr target="https://support.globalsign.com/ssl/general-ssl/securing-public-ip-address-ssl-certificates" />
		<imprint/>
	</monogr>
</biblStruct>

<biblStruct xml:id="b16">
	<monogr>
		<title level="m" type="main">The chromium projects: Dns over https (aka doh)</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Google</surname></persName>
		</author>
		<imprint/>
	</monogr>
</biblStruct>

<biblStruct xml:id="b17">
	<monogr>
		<title level="m" type="main">SA&apos;s MORECOWBELL: knell for DNS</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Christian</forename><surname>Grothoff</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Matthias</forename><surname>Wachs</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Monika</forename><surname>Ermert</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Jacob</forename><surname>Appelbaum</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2017" />
		</imprint>
	</monogr>
	<note>Unpublished technical report</note>
</biblStruct>

<biblStruct xml:id="b18">
	<analytic>
		<title level="a" type="main">Behavior-based tracking: Exploiting characteristic patterns in dns traffic</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Dominik</forename><surname>Herrmann</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Christian</forename><surname>Banse</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Hannes</forename><surname>Federrath</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Computers &amp; Security</title>
		<imprint>
			<biblScope unit="volume">39</biblScope>
			<biblScope unit="page" from="17" to="33" />
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b19">
	<analytic>
		<title level="a" type="main">Comparing the effects of DNS, DoT, and DoH on web performance</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Austin</forename><surname>Hounsel</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Kevin</forename><surname>Borgolte</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Paul</forename><surname>Schmitt</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Jordan</forename><surname>Holland</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Nick</forename><surname>Feamster</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of The Web Conference 2020</title>
		<meeting>The Web Conference 2020</meeting>
		<imprint>
			<date type="published" when="2020" />
			<biblScope unit="page" from="562" to="572" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b20">
	<monogr>
		<title level="m" type="main">Rfc 7858-specification for dns over transport layer security (tls)</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Z</forename><surname>Hu</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Zhu</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Heidemann</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Mankin</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><surname>Wessels</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Hoffman</surname></persName>
		</author>
		<ptr target="http://www.ietf.org/rfc/rfc7858.txt" />
		<imprint>
			<date type="published" when="2016" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b21">
	<monogr>
		<title level="m" type="main">Uri template</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Gregorio</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Fielding</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Hadley</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Nottinghamand</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><surname>Orchard</surname></persName>
		</author>
		<idno type="doi">DOI:10.17487/RFC6570</idno>
		<ptr target="http://www.ietf.org/rfc/rfc6570.txt.RFC6570" />
		<imprint>
			<date type="published" when="2012-03" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b22">
	<analytic>
		<title level="a" type="main">Defeating the downgrade attack on identity privacy in 5g</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Mohsin</forename><surname>Khan</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Philip</forename><surname>Ginzboorg</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Kimmo</forename><surname>Järvinen</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Valtteri</forename><surname>Niemi</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">International Conference on Research in Security Standardisation</title>
		<imprint>
			<publisher>Springer</publisher>
			<date type="published" when="2018" />
			<biblScope unit="page" from="95" to="119" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b23">
	<analytic>
		<title level="a" type="main">You are how you query: Deriving behavioral fingerprints from DNS traffic</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Wook</forename><surname>Dae</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Junjie</forename><surname>Kim</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Zhang</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">International Conference on Security and Privacy in Communication Systems</title>
		<imprint>
			<publisher>Springer</publisher>
			<date type="published" when="2015" />
			<biblScope unit="page" from="348" to="366" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b24">
	<monogr>
		<title level="m" type="main">DNS Over HTTPS traffic analysis and detection</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Carlos</forename><surname>López Romera</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2020" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b25">
	<monogr>
		<title level="m" type="main">The great DNS wall of China</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Graham</forename><surname>Lowe</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Patrick</forename><surname>Winters</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Michael L</forename><surname>Marcus</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2007" />
			<publisher>MS</publisher>
			<biblScope unit="volume">21</biblScope>
		</imprint>
		<respStmt>
			<orgName>New York University</orgName>
		</respStmt>
	</monogr>
</biblStruct>

<biblStruct xml:id="b26">
	<analytic>
		<title level="a" type="main">An End-to-End, LargeScale Measurement of DNS-over-Encryption: How Far Have We Come?</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Chaoyi</forename><surname>Lu</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Baojun</forename><surname>Liu</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Zhou</forename><surname>Li</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Shuang</forename><surname>Hao</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Haixin</forename><surname>Duan</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Mingming</forename><surname>Zhang</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Chunying</forename><surname>Leng</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Ying</forename><surname>Liu</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Zaifeng</forename><surname>Zhang</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Jianping</forename><surname>Wu</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the Internet Measurement Conference</title>
		<meeting>the Internet Measurement Conference</meeting>
		<imprint>
			<date type="published" when="2019" />
			<biblScope unit="page" from="22" to="35" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b27">
	<monogr>
		<title level="m" type="main">Web Push Notifications: Timely, Relevant, and Precise</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Joseph</forename><surname>Medley</surname></persName>
		</author>
		<ptr target="https://developers.google.com/web/fundamentals/push-notifications" />
		<imprint>
			<date type="published" when="2020" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b28">
	<monogr>
		<title level="m" type="main">Domain names-implementation and specification</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Paul</forename><surname>Mockapetris</surname></persName>
		</author>
		<ptr target="http://www.ietf.org/rfc/rfc1035.txt" />
		<imprint>
			<date type="published" when="2004" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b29">
	<monogr>
		<title level="m" type="main">Firefox dns-over-https</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Mozilla</surname></persName>
		</author>
		<ptr target="https://support.mozilla.org/en-US/kb/firefox-dns-over-https" />
		<imprint/>
	</monogr>
</biblStruct>

<biblStruct xml:id="b30">
	<monogr>
		<title level="m" type="main">Notification -Web APIs</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Mozilla</surname></persName>
		</author>
		<ptr target="https://developer.mozilla.org/en-US/docs/Web/API/notification" />
		<imprint>
			<date type="published" when="2019" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b31">
	<monogr>
		<title level="m" type="main">Anatomy of an ARP poisoning attack</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Corey</forename><surname>Nachreiner</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2003" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b32">
	<monogr>
		<title level="m" type="main">Wireshark &amp; Ethereal network protocol analyzer toolkit. Elsevier</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Angela</forename><surname>Orebaugh</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Gilbert</forename><surname>Ramirez</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Jay</forename><surname>Beale</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2006" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b33">
	<monogr>
		<title level="m" type="main">Dns queries over https (doh)</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><surname>Hoffman</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><surname>Mcmanus</surname></persName>
		</author>
		<imprint/>
	</monogr>
</biblStruct>

<biblStruct xml:id="b34">
	<monogr>
		<title/>
		<idno type="doi">DOI:10.17487/RFC8484</idno>
		<ptr target="http://www.ietf.org/rfc/rfc8484.txt.RFC8484" />
		<imprint>
			<date type="published" when="2018-10" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b35">
	<monogr>
		<title level="m" type="main">Usage profiles for dns over tls and dns over dtls</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Dickinson</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><surname>Gillmor</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><surname>Reddy</surname></persName>
		</author>
		<idno type="doi">DOI:10.17487/RFC8310</idno>
		<ptr target="http://www.ietf.org/rfc/rfc8310.txt.RFC8310" />
		<imprint>
			<date type="published" when="2018-03" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b36">
	<analytic>
		<title level="a" type="main">Encrypted DNS -&gt; privacy? a traffic analysis perspective</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Sandra</forename><surname>Siby</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Marc</forename><surname>Juarez</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Claudia</forename><surname>Diaz</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Narseo</forename><surname>Vallinarodriguez</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Carmela</forename><surname>Troncoso</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">27th Annual Network and Distributed System Security Symposium</title>
		<meeting><address><addrLine>San Diego, California, USA</addrLine></address></meeting>
		<imprint>
			<publisher>The Internet Society</publisher>
			<date type="published" when="2020" />
			<biblScope unit="volume">2020</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b37">
	<analytic>
		<title level="a" type="main">Dragonblood: Analyzing the dragonfly handshake of WPA3 and EAP-pwd</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Mathy</forename><surname>Vanhoef</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Eyal</forename><surname>Ronen</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the 2020 IEEE Symposium on Security and Privacy-S&amp;P 2020</title>
		<meeting>the 2020 IEEE Symposium on Security and Privacy-S&amp;P 2020</meeting>
		<imprint>
			<publisher>IEEE</publisher>
			<date type="published" when="2020" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b38">
	<monogr>
		<title level="m" type="main">How to Decrypt 802</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Wireshark</surname></persName>
		</author>
		<ptr target="https://wiki.wireshark.org/HowToDecrypt802.11" />
		<imprint>
			<date type="published" when="2020" />
			<biblScope unit="volume">11</biblScope>
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
