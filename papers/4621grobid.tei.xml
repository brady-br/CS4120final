<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /Users/atharsefid/Desktop/grobid-0.5.3/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.5.3" ident="GROBID" when="2020-09-29T04:26+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Through the Looking-Glass, and What Eve Found There</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Luca</forename><surname>Bruno</surname></persName>
							<affiliation key="aff0">
								<orgName type="institution">EURECOM</orgName>
							</affiliation>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Mariano</forename><surname>Graziano</surname></persName>
							<affiliation key="aff0">
								<orgName type="institution">EURECOM</orgName>
							</affiliation>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Davide</forename><surname>Balzarotti</surname></persName>
							<affiliation key="aff0">
								<orgName type="institution">EURECOM</orgName>
							</affiliation>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Aurélien</forename><surname>Francillon</surname></persName>
							<affiliation key="aff0">
								<orgName type="institution">EURECOM</orgName>
							</affiliation>
						</author>
						<title level="a" type="main">Through the Looking-Glass, and What Eve Found There</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>Looking-glasses are web applications commonly deployed by Autonomous Systems to offer restricted web access to their routing infrastructure, in order to ease remote debugging of connectivity issues. In our study, we looked at existing deployments and open-source code to assess the security of this critical software. As a result, we found several flaws and misconfigurations that can be exploited to escalate from a web attack to a remote command execution on backbone routers. This paper summarises the results of our study, and shows how even an attacker with very limited resources can exploit such flaws in operators&apos; networks and gain access to core Internet infrastructure. Depending on systems configuration, these attacks may result in traffic disruption and global BGP routes injection, with severe implications for the security of the Internet.</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">Introduction</head><p>The Internet is composed by a large number of Autonoumous Systems (AS) which cooperate to exchange and carry data across their links. Several intra-and extra-AS routing protocols running on backbone routers are responsible for distributing routes in the control plane, across the world. Some of those protocols, however, have not been designed with security in mind and are not specifically resilient against malicious agents <ref type="bibr" target="#b0">[1]</ref>.</p><p>For example, the Border Gateway Protocol (BGP) <ref type="bibr" target="#b1">[2]</ref> takes care of extra-AS routes distribution, but any malicious or wrongly configured AS can hijack and re-route prefixes owned by other ASes. Therefore, most of Internet routing relies on the assumption that no malicious BGP routers are ever allowed to announce bogus routes, and that the existing routers are benign and properly secured.</p><p>The aim of our study is to show how these assumptions do not hold true in the real-world, by focusing on a series of software flaws and widespread misconfigurations in "looking-glass" software that offers limited web-access to backbone routers.</p><p>The paper is organized as follow. In Section 1 we introduce the concept of "looking-glass" software as a public-access network debug tool, and its typical code architecture. Then, in Section 3 we outline a possible threat model, along with some of the most severe menaces. Furthermore, in Section 4 and 5 we present the results of the software review we did, and we describe the indirect experiments we performed to confirm our findings. The most relevant statistics and results of our experiments are shown in Section 6, along with an empirical rough estimation of BGP injection feasibility, based on historical records. Finally, Section 8 summarises our findings and give some insights on the current state of the Internet infrastructure.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">Background</head><p>An AS infrastructure is composed of several network services, each handled by different systems and devices.</p><p>For the purposes of this paper, we will limit our focus to just two categories of systems that are strictly related to Internet routing: backbone BGP routers and Linuxbased route servers.</p><p>• Backbone routers</p><p>The worldwide Internet backbone is run on top of dedicated network devices capable of accelerated packet routing in the data-plane, using custom ASICs and dedicated hardware.</p><p>These devices run a custom OS and control-plane stack which is responsible for computing the routing topology, e.g., by participating in BGP sessions with neighbors. In addition, all these devices have one or more interfaces for remote and out-of-band (OOB) administration, like a telnet service, a SSH service, or a remote serial port. The access to these interfaces should be strictly restricted to Network Operations Center (NOC) operators and authorized AS personnels.</p><p>• Route servers Routing software exists for traditional Linuxbased servers to establish BGP sessions with other routers and servers. Two prominent examples are Quagga <ref type="bibr" target="#b2">[3]</ref> and Xorp <ref type="bibr" target="#b3">[4]</ref>, which are used by several operators and are under active development.</p><p>The usages of route servers are multiple, from providing a read-only copy of the global BGP table to allowing scripting of BGP rules (e.g., by using traditional UNIX utilities). Also these servers can be accessed out-of-band by AS personnel, via telnet or SSH.</p><p>Some public services exist, like the Route Views project <ref type="bibr">[5]</ref>, which provide unrestricted telnet access to their route servers to expose a read-only copy of the BGP table to analysts and researchers. However, those services are purposefully meant for public access, and are therefore outside the scope of this paper.</p><p>When debugging BGP routing problems, NOC operators are often facing issues affecting only a few ASes. Such problems are harder to debug due to the lack of a view on the remote routing table.</p><p>For this reason, a new category of web-applications emerged in the '90s to permit a restricted set of operations on AS routers and route servers by the large public, over the web. This kind of software is usually referred as "looking-glass", as it offers a local observation point to remote network engineers.</p><p>Looking-glasses are web scripts, usually implemented in Perl or PHP and directly connected to routers admin interfaces (i.e., telnet or SSH). These scripts are designed to relay textual commands from the web to the router and print back the router' replies. They run on top of common Linux/Apache stacks, and sometimes provide addi-  tional utilities for latency and traceroute measurements. <ref type="figure" target="#fig_0">Figure 1</ref> briefly shows their typical architecture and deployment.</p><p>We decided to focus our attention on looking-glass software, as most of them are small and old webapplications that have been last updated in early 2000s.</p><p>In this paper we analyse what we found to be the most commonly used open-source software looking-glasses, as listed in <ref type="table" target="#tab_0">Table 1</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">Threat model</head><p>A looking-glass is an often overlooked critical part of an operator infrastructure, as it sits at the border between the public web and restricted admin consoles. As such, the threat model encompasses both the typical web security scenario and some more custom networking threats.</p><p>We categorized some of the most relevant issues as follow:</p><p>• Reverse Cross-Channel Scripting (Reverse-XCS)</p><p>Reverse-XCS are defined by Bojinov et al. <ref type="bibr" target="#b9">[11]</ref> as "the use of web interface to eventually attack a nonweb channel".</p><p>In our scenario, this translates to two relevant cases:</p><p>-Malicious command injection Bypassing a weak or non-existent commands sanitization, an attacker may trick the lookingglass into sending malformed commands to a router console, e.g., to trigger a DoS on the control-plane.</p><p>-Routing Information Base (RIB) manipulation By exploiting flaws in the looking-glass, an attacker may inject arbitrary commands to manipulate the RIB on the router, e.g., by changing the BGP configuration. If the attacked router relays its topology to neighboring ASs, this may also affect remote networks.</p><p>• Web flaws Typical web threats applies here too. In particular, we highlight two of the most relevant cases:</p><p>-Exposed routers credentials</p><p>The configuration files of a looking glass contain IP addresses, usernames, and passwords in cleartext. If not properly secured, an attacker may be able to gather credentials by guessing the URLs of configuration files.</p><p>-Cookies stealing via XSS Even though looking-glass applications are usually unauthenticated, an attacker may exploit XSS flaws in them to gather admin cookies for other administration web-applications served under the same-origin domain.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">Threat Analysis</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.1">Misconfigurations</head><p>Misconfiguration or improper access control of resources are two of the most basic, yet important, issues for web security. First of all, if server modules are not properly configured, it may be possible to get a listing of supposedly private files -including source codes and configuration files. In this case, search engine bots are capable of crawling and inspecting the files content, thus making login credentials easy to gather by searching for ad-hoc Google-dorks <ref type="bibr" target="#b10">[12]</ref>.</p><p>Another possible issue comes from temporary files. In this case, source code and configurations could be recovered by looking for temporary editor files (e.g., ending in ∼) on the web server. This can as well help an attacker confirm which version of the software is run by a targeted operator, and may pose a bigger problem for proprietary/custom looking-glasses.</p><p>Moreover, configurations and login credentials for routers may be stored as plain text files in the same web server directory. By default, web-servers will serve them as plain-text to anyone querying the proper URL. By inspecting source code and looking at default file names, it is possible to guess the URL of configuration files and, if not properly protected, retrieve them.</p><p>Finally, some software allows advanced authentication methods, for example by using SSH public/private keypairs instead of cleartext passwords. In this case, the path to the SSH key is stored in the configuration files, instead of the full passwords. However, the SSH keys themselves could be stored by mistake in the same path, openly readable to the entire world.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.2">Poor network policies</head><p>Backbone routers are parts of a critical infrastructure and as such their admin interfaces have to be properly secured. Cisco's own best practices <ref type="bibr">[13]</ref>, for example, recommend exposing consoles only over out-of-band loopback interfaces, unreachable from the public Internet (e.g., by using private addresses and placing them in dedicated admin VLANs).</p><p>However, some operators may decide to put loopback interfaces on publicly routable networks, or to expose administration services on all router's interfaces. In such cases, a remote attacker may be able to directly login onto them, e.g., by using stolen credentials.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.3">Web security</head><p>It is usually recommended that actionable web applications make use of captcha or other automation blocker to avoid scripted attacks <ref type="bibr" target="#b11">[14]</ref>. While this may not look like a big issue for looking-glasses, the lack of this countermeasure can effectively help an attacker to automatically map resources in an AS infrastructure and scan them for information gathering. This may also result in automated bot attacks aimed at DoSing connected devices or other parts of the network.</p><p>Moreover, an attacker may be able to exploit insufficient input parameters sanitization to perform XSS and inject HTML/JS code in web responses. While lookingglasses are usually unauthenticated, this flaw can be used to steal admin cookies for other panels hosted under the same-origin domain.</p><p>Similarly, it could be possible to perform a Reverse-XCS against the network infrastructure. If web input is not properly sanitized, an attacker may forge input parameters to inject custom commands into the router console. This directly means an escalation from a web attack to an Internet routing attack if the attacker manages to modify the router configuration.</p><p>Finally, some software may come with additional tools to be deployed directly on the web-server to perform advanced measurements (e.g., high granularity latency measurements). Such tools may as well include vulnerabilities, leading to remote code execution on the lookingglass server itself.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.4">Impact</head><p>Most of the threats described so far can result in an attacker getting unauthorised access to the administration interface of a router, under the same access level of the looking-glass software.</p><p>In a typical network topology designed as in <ref type="figure" target="#fig_0">Figure 1</ref>, this results into having an observation point into the private part of an AS infrastructure, and possibly manipulating portions of it. Moreover, an attacker with restricted console access to a router could easily elevate his privileges by cracking weakly-hashed secrets <ref type="bibr">[15]</ref> (e.g., Cisco's ciphers Type-0, Type-5 and Type-4 <ref type="bibr" target="#b12">[16]</ref>) or by abusing known authorization bypass vulnerabilities that affected several top vendors <ref type="bibr" target="#b13">[17,</ref><ref type="bibr" target="#b14">18]</ref>.</p><p>The impact of a malicious attacker with elevated privileges on a backbone routers are manifold with respect to both the local AS infrastructure and the global Internet. For example, by altering internal or external routing configurations, an attacker may be able to blackhole or disrupt specific subnetworks, or set up traffic mirroring or re-routing scenarios for further attacks.</p><p>We consider the post-exploitation analysis of such a scenario to be complex and quite specific to single vendors, devices, and network setup. As a result, we will not cover post-exploitation details in the rest of this paper. However, we would like to stress the fact that backbone routers are usually capable of announcing routes both internally (e.g., into an OSPF domain) and to the whole Internet (i.e., to peering ASes via BGP). As such, in this threat analysis we have highlighted one possible path for a remote attacker with modest resources to escalate from a web attack, to a remote command injection into multiple backbone routers, to injecting malicious announces into the Internet BGP table.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5">Experiments</head><p>Given the theoretical attack surface presented in Section 3, we tried to assess how many ASes worldwide were actually vulnerable to remote attackers. Our goal was complicated by the fact that, due to ethical and legal considerations, we could not perform direct experiments, e.g., by injecting commands on remote routers or by just trying to login into them.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.1">Ethical concerns</head><p>Unauthorized access to computers and network devices is prosecuted by several national and international laws.</p><p>Since in this paper we conducted a comprehensive study, encompassing 26 countries with different legislations, we took ethical considerations as a top priority. For this reason we avoided any direct connections to routers and other devices we found online, even when credentials where publicly exposed. We performed our analysis and code review of the looking-glass software in a local setting, performing the injection experiments in a controlled environment, as described further below.</p><p>During our research we found several vulnerabilities and misconfigurations. Unfortunately, in most of the cases these flaws were trivial to detect and to exploit, significantly increasing the relevance of our study. For this reason, we decided to responsible disclose the vulnerabilities and misconfigurations by contacting the CERT/CC in order to coordinate all the entities involved. In addition, we contacted and reported our findings to the software developers, who acknowledged the problems and are working on fixes.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.2">Methodology</head><p>Not all ASes provide public looking-glasses, and there is not a single central list containing all of them. As such, we compiled a list of known ones on a best-effort basis by collecting URL from operators-related resources.</p><p>Such resources are not updated frequently and may contain unreachable or inactive services, while missing recent ones. We started filtering out the inactive entries by connecting to them and looking for network or web failures. For the remaining ones, we performed a simple HTTP request, matching the returned page with a set of HTML signatures we developed for each open-source looking glass we were able to download. At the end of this fingerprinting phase, we obtained the list of the most popular open-source software, and which ASes are using them.</p><p>We then proceed to perform a security review of their codebase, especially looking for the kind of issues we described in Section 4. At the same time, we also collected a list of default paths for configuration files, sources, and keys. This knowledge base was subsequently used to scan web servers and search engine indexes for publicly exposed configurations and key files.</p><p>At this point, we focused our tests on the subset of ASes for which we identified an existing security problem. In our experiment, we first tried to enumerate at least one public IP for all routers connected to a lookingglass, by requesting an ICMP echo request to one public IP address under our control. We then looked for IP addresses publicly exposing an admin service (telnet or SSH). We performed this test by checking for publicly routable loopbacks or services listening on routing interfaces. These actions were easy to automate, as  none of the open-source looking-glass software employ CAPTCHAs.</p><p>At the end of our experiments, we identified a subset of vulnerable ASes, for which an attacker could be capable of directly injecting commands on the router or could be able to recover the credentials required to remotely log in in a publicly accessible interface.</p><p>We then correlated this list of ASes with historical records of BGP announces collected by RIPE RIS through several probes and peers, all over the world. The results suggest that by compromising some of these ASes it would probably be possible for an attacker to announce routes that would not be properly filtered by neighbouring ASes.</p><p>We acknowledge that this methodology may result in several false-negatives (URLs not in the original list, unavailable at the time of the experiment, or missed while fingerprinting) and few false-positives (updated and well-configured routers with proper ACL).</p><p>For the former, one could repeat the experiments in the future to compare the results. Unfortunately, it is impossible to remove the false positives without performing a real test on the routers -action that we could not perform for ethical reasons.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6">Results</head><p>After an initial fingerprinting phase, we collected 919 unique URLs of looking-glass applications, out of which 220 were running one of open-source software listed in <ref type="table" target="#tab_0">Table 1</ref>. The remaining ones were either unreachable (184 cases), or running a custom code we were not able to identify with our signatures (515).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6.1">Impacted ASes</head><p>An initial lookup on web search engines already proved fruitful, with at least 4 configuration files crawled by indexing bots.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Vulnerabilities Affected ASes</head><p>Exposed configuration files 28</p><p>Remote command injection 12</p><p>Misconfigured CGI 4</p><p>Exposed SSH private keys 2 Looking for misconfigurations, we observed a large number of exposed credentials by just visiting the default configuration paths for each software, as gathered from the source code. At least 28 configuration files containing IPs and credentials can be directly downloaded by malicious attackers, and in two cases we also observed private SSH keys exposed on the web server.</p><p>Focusing on the source-code, we observed a general lack of basic security practices. As already said, none of above software make use of anti-automation mechanisms. The most worrisome result of our review was one case of missing input sanitation mechanism which allows injection of arbitrary commands to the router console <ref type="bibr">(CVE-2014-3927 [19]</ref>). We also observed three cases of insecure default paths and permissions, mostly the cause of the exposed credentials mentioned above <ref type="bibr">(CVE- 2014-3928 [20]</ref>, CVE-2014-3929 <ref type="bibr" target="#b16">[21]</ref> and CVE-2014-3930 <ref type="bibr" target="#b17">[22]</ref>). In one case, the result page was vulnerable to a XSS attack <ref type="bibr">(CVE-2014-3926 [23]</ref>).</p><p>On the host side, an interesting finding was a remote memory corruption related to the parsing of ICMPresponse fields in a bundled ping-like utility, meant to be run as SUID on the looking-glass web server <ref type="bibr">(CVE- 2014-3931 [24]</ref>).</p><p>To summarize, we detected a total of 46 vulnerable ASes, which could be targeted by attackers in order to gain access to the Internet infrastructure. A quick summary of the issues is shown in <ref type="table" target="#tab_3">Table 3</ref>. <ref type="figure" target="#fig_2">Figure 2</ref> plots the number of affects ASes by country. The most vulnerable nation is Russia with six ASes, followed by Poland with four. Then there are 16 countries with a vulnerable AS. However, none of these ASes are known tier-1 provider.</p><p>Through the use of looking-glasses and network probes, we globally identified 53 routers across 20 ASes publicly exposing telnet or SSH services. This figure does not include known public route servers, typically accessed over telnet, which have been filtered out from this set.</p><p>Finally, by combining all this data, we were able to correlate two leaked configurations to ASes whose routers administration services were listening on routable IPs. In total, we observed six routers connected to looking-glass instances which are directly reachable over telnet and for which credentials are publicly exposed.</p><formula xml:id="formula_0">R U P L D E N L R S H U C H G B U A U S F R B G H K M K B R R O C L C A I T A L C Z A U I E S G S E A</formula><p>As the final result of our experiments, we identified at least 14 ASes which are highly interesting for attackers targeting the Internet infrastructure: 12 of them run software that is vulnerable to arbitrary commands injection, while the remaining 2 have a largely exposed infrastructure.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6.2">BGP injection feasibility</head><p>A malicious attacker capable of manipulating BGP sessions may affect the network traffic across the world. Fortunately, several mechanisms exist to limit wordlwide issues, most notably prefix filtering in which upstreams and peers filter a neighbouring AS to only announcing known routes, effectively preventing malicious injection.</p><p>However, several past hijacks <ref type="bibr" target="#b20">[25]</ref> and academic studies <ref type="bibr" target="#b21">[26]</ref> have shown how often BGP announces are not properly filtered, resulting in misconfigurations and hijacks being observed in the wild.</p><p>While BGP anomaly analysis is a complex subject outside of the scope of this paper, we tried to assess if it is possible for an attacker controlling any of the above vulnerable ASes to announce unfiltered routes. At this point, we are interested in knowing if some peers of those ASes were not applying proper filters, by looking into anomalies detected by the RIPE RIS.</p><p>By manually analysing historical data, we spotted at least three such cases where anomalous announces where recorded by BGP collectors over the low-visibility threshold (i.e., relied by multiple peers).</p><p>In two cases, overlong prefixes (more specific than /24) where observed by multiple participating peers, while in the remaining case an event lasting 8h occurred where one AS briefly announced an unrelated prefixes already in use (a short multi-origin AS event, possibly due to a temporary misconfiguration).</p><p>Such unfiltered prefixes hint at the possibility for a remote attacker to distribute bogus BGP routes, by compromising one of above ASes.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="7">Related Work</head><p>Backbone routers are the main players of the Internet core infrastructure, and they are considered key points for cyberspace security. For these reasons, these devices have been studied from several perspectives.</p><p>Remote exploitation of routers has been studied in the past, with Lindner showing the feasibility and the technical challenges for Cisco IOS <ref type="bibr" target="#b22">[27,</ref><ref type="bibr" target="#b23">28,</ref><ref type="bibr" target="#b24">29]</ref> as well as for Huawei VRP <ref type="bibr" target="#b25">[30]</ref>. Since then, other researchers focused their attention on the remote exploitation of Cisco routers <ref type="bibr" target="#b26">[31,</ref><ref type="bibr" target="#b27">32]</ref> and the firmware diversity problem <ref type="bibr" target="#b28">[33]</ref>.</p><p>Despite the importance of these devices, serious local flaws are still being found <ref type="bibr" target="#b29">[34]</ref>, allowing an attacker with console access to escalate his privileges. The impact of these local flaws could be exacerbated by network engineers not following security best-practices, as shown in this paper.</p><p>Researchers also focused their attention on the defacto interdomain routing protocol, BGP. In this case, the threat model consists in taking control of a BGP device and announcing false routes or hijacking prefixes <ref type="bibr" target="#b31">[35,</ref><ref type="bibr" target="#b32">36,</ref><ref type="bibr" target="#b21">26]</ref>. This is possible because BGP has been designed with the concept of trust, at a time in which security was not a real concern <ref type="bibr" target="#b0">[1]</ref>. Several solutions have been proposed in the literature, ranging from the use of cryptography (e.g. PKI for a root of trust) <ref type="bibr" target="#b33">[37,</ref><ref type="bibr" target="#b34">38]</ref> to anomaly detection <ref type="bibr" target="#b35">[39,</ref><ref type="bibr" target="#b36">40]</ref>. Unfortunately, they are not widely used by network providers.</p><p>More specific to looking-glass applications, researchers have found some vulnerabilities in the past, but their focus was on the execution of code on the server running the looking-glass software <ref type="bibr" target="#b37">[41]</ref>. Some concerns related to information leakage were also raised on public mailing lists <ref type="bibr" target="#b38">[42,</ref><ref type="bibr" target="#b39">43]</ref>. However, to the best of our knowledge, no comprehensive studies had been conducted so far on this class of applications.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="8">Conclusions</head><p>We believe that our study shows how basic best-practices are not uniformly applied by operators across the world, and how an attacker can target several ASes to disrupt the Internet without much effort.</p><p>Just by looking at public information gathered on the web and applying simple heuristics, we have been able to detect a large number of attack surfaces in this critical infrastructure. In particular, we directly identified at least 45 exposed ASes, we found six routers across two ASes which could be remotely accessed by malicious attackers via exposed credentials, and at least 12 additional ASes vulnerable to arbitrary commands injection through the web interface. Moreover, we have spotted unfiltered prefixes originating from at least three of these ASes in the past.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Figure 1 :</head><label>1</label><figDesc>Figure 1: Looking glass architecture.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>Figure 2 :</head><label>2</label><figDesc>Figure 2: Geographical distribution of vulnerable ASes.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0" validated="false"><head>Table 1 :</head><label>1</label><figDesc></figDesc><table>Open-source looking-glass software. 

</table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_2" validated="false"><head>Table 2 : Looking-glass software deployments.</head><label>2</label><figDesc></figDesc><table></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_3" validated="false"><head>Table 3 :</head><label>3</label><figDesc></figDesc><table>Number of vulnerable ASes. 

</table></figure>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Acknowledgements</head><p>We would like to thank Pierre-Antoine Vervier and Quentin Jacquemart for patiently discussing and advising us on the complex topic of BGP analysis. Moreover, we would like to thank Thijs Kinkhorst and ANSSI personnel for directing us in the initial disclosure steps.</p></div>
			</div>

			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<monogr>
		<title level="m" type="main">BGP Security Vulnerabilities Analysis. RFC 4272 (Informational)</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Murphy</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2006-01" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b1">
	<monogr>
		<title level="m" type="main">A Border Gateway Protocol 4 (BGP-4). RFC 4271 (Draft Standard)</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Y</forename><surname>Rekhter</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><surname>Li</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Hares</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2006-01" />
			<biblScope unit="volume">6286</biblScope>
			<biblScope unit="page">6793</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Quagga Routing Suite</surname></persName>
		</author>
		<ptr target="http://www.nongnu.org/quagga/" />
		<imprint/>
	</monogr>
</biblStruct>

<biblStruct xml:id="b3">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Xorp -Extensible Open Router</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Platform</surname></persName>
		</author>
		<ptr target="http://www.xorp.org/" />
		<imprint/>
	</monogr>
</biblStruct>

<biblStruct xml:id="b4">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><forename type="middle">G</forename><surname>Cougar</surname></persName>
		</author>
		<ptr target="https://github.com/Cougar/lg" />
		<imprint/>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><forename type="middle">G</forename><surname>Cistron</surname></persName>
		</author>
		<ptr target="http://www.tux.org/pub/people/miquel-van-smoorenburg/net/" />
		<imprint/>
	</monogr>
</biblStruct>

<biblStruct xml:id="b6">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Mrlg</surname></persName>
		</author>
		<ptr target="http://mrlg.op-sec.us/" />
		<imprint/>
	</monogr>
</biblStruct>

<biblStruct xml:id="b7">
	<analytic>
		<title/>
		<ptr target="http://freecode.com/projects/mrlg4php" />
	</analytic>
	<monogr>
		<title level="j">MRLG4PHP</title>
		<imprint/>
	</monogr>
</biblStruct>

<biblStruct xml:id="b8">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><forename type="middle">G</forename><surname>Telephone</surname></persName>
		</author>
		<ptr target="https://github.com/telephone/LookingGlass" />
		<imprint/>
	</monogr>
</biblStruct>

<biblStruct xml:id="b9">
	<analytic>
		<title level="a" type="main">XCS: cross channel scripting and its impact on web applications</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Hristo</forename><surname>Bojinov</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Elie</forename><surname>Bursztein</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Dan</forename><surname>Boneh</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">ACM Conference on Computer and Communications Security</title>
		<imprint>
			<date type="published" when="2009" />
			<biblScope unit="page" from="420" to="431" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b10">
	<monogr>
		<title level="m" type="main">Google Hacking for Penetration Testers</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Johnny</forename><surname>Long</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2005" />
			<pubPlace>Black Hat USA</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b11">
	<analytic>
		<title level="a" type="main">CAPTCHA: Using Hard AI Problems for Security</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Luis</forename><surname>Ahn</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Von</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Manuel</forename><surname>Blum</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Hopper</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Nicholas</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">John</forename><surname>Langford</surname></persName>
		</author>
		<idno>EURO- CRYPT&apos;03</idno>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the 22Nd International Conference on Theory and Applications of Cryptographic Techniques</title>
		<meeting>the 22Nd International Conference on Theory and Applications of Cryptographic Techniques</meeting>
		<imprint>
			<date type="published" when="2003" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b12">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Psirt</forename><surname>Cisco</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Cisco Ios Xe</forename><surname>Cisco</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Type</surname></persName>
		</author>
		<imprint/>
	</monogr>
</biblStruct>

<biblStruct xml:id="b13">
	<monogr>
		<title level="m" type="main">AAA Command Authorization by-pass</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Psirt</forename><surname>Cisco</surname></persName>
		</author>
		<ptr target="http://tools.cisco.com/security/center/content/CiscoSecurityResponse/cisco-sr-20060125-aaatcl" />
		<imprint/>
	</monogr>
</biblStruct>

<biblStruct xml:id="b14">
	<monogr>
		<title level="m" type="main">19] mrlg4php: remote command injection to router&apos;s console via &quot;argument</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Juniper</forename><surname>Networks</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Sirt</forename></persName>
		</author>
		<ptr target="http://www.s3.eurecom.fr/cve/CVE-2014-3927.txt" />
		<imprint>
			<date type="published" when="2010" />
		</imprint>
	</monogr>
	<note>Unauthorized user can obtain root access using cli</note>
</biblStruct>

<biblStruct xml:id="b15">
	<monogr>
				<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">-Lg</forename><surname>Cougar</surname></persName>
		</author>
		<ptr target="http://www.s3.eurecom.fr/cve/CVE-2014-3928.txt" />
		<title level="m">Unsafe configuration file path/ACL</title>
		<imprint>
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b16">
	<monogr>
				<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">-Lg</forename><surname>Cougar</surname></persName>
		</author>
		<ptr target="http://www.s3.eurecom.fr/cve/CVE-2014-3929.txt" />
		<title level="m">Unsafe SSH keypairs path in default config</title>
		<imprint>
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b17">
	<monogr>
				<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">-Lg</forename><surname>Cistron</surname></persName>
		</author>
		<ptr target="http://www.s3.eurecom.fr/cve/CVE-2014-3930.txt" />
		<title level="m">Unsafe configuration file path/ACL</title>
		<imprint>
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b18">
	<monogr>
				<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">-Lg</forename><surname>Cougar</surname></persName>
		</author>
		<ptr target="http://www.s3.eurecom.fr/cve/CVE-2014-3926.txt" />
		<title level="m">XSS in title via &quot;addr</title>
		<imprint>
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b19">
	<monogr>
				<ptr target="http://www.s3.eurecom.fr/cve/CVE-2014-3931.txt" />
		<title level="m">MRLG: remote memory corruption in fastping (SUID binary</title>
		<imprint>
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b20">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Earl</forename><surname>Zmijewski</surname></persName>
		</author>
		<ptr target="http://www.renesys.com/2014/04/indonesia-hijacks-world/" />
	</analytic>
	<monogr>
		<title level="j">Indonesia Hijacks the World</title>
		<imprint/>
	</monogr>
</biblStruct>

<biblStruct xml:id="b21">
	<analytic>
		<title level="a" type="main">A Study of Prefix Hijacking and Interception in the Internet</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Hitesh</forename><surname>Ballani</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Paul</forename><surname>Francis</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Xinyang</forename><surname>Zhang</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the 2007 Conference on Applications, Technologies, Architectures, and Protocols for Computer Communications, SIG-COMM &apos;07</title>
		<meeting>the 2007 Conference on Applications, Technologies, Architectures, and Protocols for Computer Communications, SIG-COMM &apos;07<address><addrLine>New York, NY, USA</addrLine></address></meeting>
		<imprint>
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b22">
	<monogr>
		<title level="m" type="main">Attacking networked embedded systems</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">F</forename><forename type="middle">X</forename></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Ftr</forename></persName>
		</author>
		<imprint>
			<date type="published" when="2002" />
			<pubPlace>Black Hat USA</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b23">
	<monogr>
		<title level="m" type="main">FX&quot; Lindner. Cisco Vulnerabilities -Yesterday, Today and Tomorrow</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Felix</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2003" />
			<pubPlace>Black Hat USA</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b24">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">&amp;quot;</forename><surname>Felix</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Fx</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Lindner. Cisco IOS Router Exploitation. Black Hat USA</title>
		<imprint>
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b25">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Felix</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">FX&quot; Lindner. Hacking Huawei Routers. DEFCON XX</title>
		<imprint>
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b26">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Michael</forename><surname>Lynn</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Cisco</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Shellcode</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2005" />
			<pubPlace>Black Hat USA</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b27">
	<monogr>
		<title level="m" type="main">Remote Cisco IOS FTP exploit</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Andy</forename><surname>Davis</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b28">
	<analytic>
		<title level="a" type="main">Killing the Myth of Cisco IOS Diversity: Recent Advances in Reliable Shellcode Design</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Ang</forename><surname>Cui</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Jatin</forename><surname>Kataria</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Salvatore</forename><forename type="middle">J</forename><surname>Stolfo</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">WOOT</title>
		<imprint>
			<date type="published" when="2011" />
			<biblScope unit="page" from="19" to="27" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b29">
	<monogr>
		<title level="m" type="main">Multiple privilege escalation vulnerabilities in Junos CLI (CVE-2014-0615)</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Juniper</forename><surname>Networks</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Sirt</forename></persName>
		</author>
		<imprint/>
	</monogr>
</biblStruct>

<biblStruct xml:id="b30">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Us&amp;amp;searchid=1400663655904</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b31">
	<analytic>
		<title level="a" type="main">A Survey of BGP Security Issues and Solutions</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Kevin</forename><forename type="middle">R B</forename><surname>Butler</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Toni</forename><forename type="middle">R</forename><surname>Farley</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Patrick</forename><surname>Mcdaniel</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Jennifer</forename><surname>Rexford</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the IEEE</title>
		<meeting>the IEEE</meeting>
		<imprint>
			<date type="published" when="2010" />
			<biblScope unit="volume">98</biblScope>
			<biblScope unit="page" from="100" to="122" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b32">
	<analytic>
		<title level="a" type="main">Understanding the Network-level Behavior of Spammers</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Anirudh</forename><surname>Ramachandran</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Nick</forename><surname>Feamster</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the 2006 Conference on Applications, Technologies, Architectures, and Protocols for Computer Communications, SIGCOMM &apos;06</title>
		<meeting>the 2006 Conference on Applications, Technologies, Architectures, and Protocols for Computer Communications, SIGCOMM &apos;06</meeting>
		<imprint>
			<date type="published" when="2006" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b33">
	<monogr>
		<title level="m" type="main">Public-key infrastructure for the Secure Border Gateway Protocol (S-BGP)</title>
		<imprint>
			<date type="published" when="2001" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b34">
	<monogr>
				<ptr target="http://www.ietf.org/rfc/rfc2385.txt" />
		<title level="m">RFC 2385 -Protection of BGP Sessions via the TCP MD5 Signature Option</title>
		<imprint>
			<date type="published" when="1998" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b35">
	<analytic>
		<title level="a" type="main">BGP Routing Policies in ISP Networks</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Caesar</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Rexford</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Netwrk. Mag. of Global Internetwkg</title>
		<imprint>
			<date type="published" when="2005" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b36">
	<analytic>
		<title level="a" type="main">Beware of BGP Attacks. SIGCOMM Comput</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Ola</forename><surname>Nordström</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Constantinos</forename><surname>Dovrolis</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Commun. Rev</title>
		<imprint/>
	</monogr>
</biblStruct>

<biblStruct xml:id="b37">
	<monogr>
		<title level="m" type="main">Looking Glass v20040427 arbitrary commands execution / cross site scripting</title>
		<ptr target="http://retrogod.altervista.org/lookingglass.html" />
		<imprint>
			<date type="published" when="2005" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b38">
	<analytic>
		<title/>
		<ptr target="http://www.gossamer-threads" />
	</analytic>
	<monogr>
		<title level="j">BGP</title>
		<imprint/>
	</monogr>
</biblStruct>

<biblStruct xml:id="b39">
	<monogr>
				<ptr target="http://www.nanog.org/mailinglist/mailarchives/old_archive/2004-04/msg00684.html" />
		<title level="m">TCP BGP vulnerability looking glass and route server issues</title>
		<imprint>
			<date type="published" when="2004" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
