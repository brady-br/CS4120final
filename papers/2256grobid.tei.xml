<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /Users/atharsefid/Desktop/grobid-0.5.3/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.5.3" ident="GROBID" when="2020-09-29T02:32+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Malware Analysis Through High-level Behavior</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Xiyue</forename><surname>Deng</surname></persName>
							<email>xiyueden@isi.edu</email>
							<affiliation key="aff0">
								<orgName type="department">Information Sciences Institute</orgName>
							</affiliation>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Jelena</forename><surname>Mirkovic</surname></persName>
							<email>mirkovic@isi.edu</email>
							<affiliation key="aff0">
								<orgName type="department">Information Sciences Institute</orgName>
							</affiliation>
						</author>
						<title level="a" type="main">Malware Analysis Through High-level Behavior</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>Malware is becoming more and more stealthy to evade detection and analysis. Stealth techniques often involve code transformation, ranging from equivalent code substitution and junk code injection, to continuously transforming code using a polymorphic or a metamorphic engine. Evasion techniques have a great impact on signature-based malware detection, making it very costly and often unsuccessful. We propose to study a malware&apos;s network behavior during its execution. While malware may transform its code to evade analysis, we contend that its behavior must mostly remain the same to achieve the malware&apos;s ultimate purpose, such as sending spam, scanning for vulnerable hosts, etc. While live malware analysis is hard, we leverage our Fantasm platform on the Deter-Lab testbed to perform it safely and effectively. Based on observed network traffic we propose a behavior classification approach, which can help us interpret the mal-ware&apos;s actions and its ultimate purpose at a high level. We then apply our approach to 999 diverse samples from the Georgia Tech Apiary project to understand current trends in malware behaviors.</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">Introduction</head><p>Contemporary state of Internet security is grave, thanks to proliferation of malware. Malware is an increasing threat, not only because of its increased capability and sophistication, but also because of its stealth, aimed at avoiding detection and analysis.</p><p>Because anti-virus suites usually apply signaturebased malware detection, malware designers have invested enormous effort to change their binaries to avoid detection. From simple instruction transformation, such techniques have evolved through junk code injection, code obfuscation, to polymorphic and metamorphic engines that can transform malware code into millions of variants <ref type="bibr" target="#b16">[17]</ref>. Such obfuscation techniques have greatly undermined traditional signature-based malware detection methods. We simply cannot keep pace with proliferating malware variants. Notable attempts have been made by researchers to improve signature analysis by running AV suites on cloud <ref type="bibr" target="#b21">[22]</ref>, detecting encryption decoders <ref type="bibr" target="#b14">[15]</ref>, detecting runtime signatures for polymorphic malwares <ref type="bibr" target="#b23">[24]</ref>, etc. However, as new obfuscation techniques emerge, signature analysis alone cannot save us.</p><p>Besides static analyses, researchers have used dynamic analysis to overcome code obfuscation. These include tracking disk changes, analyzing dynamic call graphs, as well as monitoring malware execution using debuggers and virtual machines. However, modern malware is often equipped with anti-debugging and antivirtualization capabilities <ref type="bibr" target="#b17">[18,</ref><ref type="bibr" target="#b18">19]</ref>, making its analysis in a controlled environment difficult. Yet, a controlled environment is needed to observe a malware's actions on the compromised host, and record sufficient details for analysis.</p><p>To complement contemporary static and dynamic code analysis, we propose to study malware behavior by observing and interpreting its network activity. Based on our prior research <ref type="bibr" target="#b5">[6]</ref>, we believe that network access is essential for malware to achieve its purpose. We also believe that it would be difficult for malware to significantly alter its network behavior and still achieve its purpose. Studying network behavior thus may offer an opportunity to both understand what malware is trying to do in an analysis environment, and to detect malware on compromised hosts. In this paper we pursue this first direction, by investigating how we can infer the malware's ultimate purpose by analyzing its network activity.</p><p>Live malware analysis, with unrestricted network access, is risky, because malware may inflict damage to other Internet hosts during analysis, and we would become unwitting accomplices. We leverage our Fantasm system for safe and productive live malware analysis <ref type="bibr" target="#b5">[6]</ref> to minimize this risk.</p><p>Just having network traffic records of a malware run is not enough to understand a malware's purpose, because such data is very rich and very unstructured. To overcome this challenge, we first extract a set of features from network traffic records, and then devise patterns that help us group these features into higher-level behaviors, such as file download, e-mail sending, scanning, etc. Next we use a set of these high-level behaviors to label malware by its purpose. We note that malware could have more than one purpose. For example, it could both scan for vulnerable hosts and send unsolicited emails. Thus a malware sample could have more than one label.</p><p>We perform our analysis on 999 malware samples, randomly selected from the Georgia Tech Apiary project <ref type="bibr" target="#b0">[1]</ref>. We observe that the most common activities are scanning, propagating, and downloading. Interestingly, of all samples that show more than one behavior, scanning and propagating show up most frequently together, which suggests these activities usually work in combination and complement each other.</p><p>Our paper is structured as follows. We discuss background of this work and contemporary research in Section 2. In Section 3 we explain our methodology. We define our classification criteria in Section 4; We describe experiment set up and evaluation in Section 5. We discuss the use of the results and possible future work in Section 6 and conclude in Section 7.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">Background and Related Work</head><p>In this section we discuss contemporary malware analysis methods and the rationale behind our research methods, and also survey related work.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1">Static Analysis</head><p>Various static analysis methods like CTPL <ref type="bibr" target="#b10">[11]</ref>, Generic Virus Scanner <ref type="bibr" target="#b4">[5]</ref>, etc. have been used to analyze binary code of malware without running it, and identify portions that could be used for signature generation. These portions of code exhibit malicious activity, and are unlikely to present in benign binaries. The identified portion is then synthesized to become the signature of this kind of malware. Once the signature is obtained, researchers can build anti-virus tools to find the same kind of malware in future by scanning all suspicious binaries.</p><p>Signature-based malware detection has been the most widely used method and has been quite successful. However, malware designers have also been working on countermeasures over the years to undermine such techniques. From junk code generation, malware encryption and oligomorphism, to polymorphic and metamorphic malware <ref type="bibr" target="#b16">[17]</ref>, such techniques have evolved significantly against signature-based detection techniques. On the other hand, researchers have also been improving signature detection methods, such as detecting decryption routines, runtime signature detection, etc. Overall, this is a losing race for the researchers, as it will always be cheaper to generate new malware variants, than to analyze them. We can become faster, but we can never win. Our proposed direction shows promise because malware cannot change its network behavior with as much freedom as changing its code. We thus believe that we will be able to analyze and detect those malware samples that static analysis misses.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2">Dynamic Analysis on Host</head><p>Instead of looking for a binary signature to detect malware presence, dynamic analysis builds a signature of a malware's interaction with its host. This signature may include memory access and file access patterns, as well as system call patterns. Those patterns that are likely to be present in malware but not in benign binaries can be used to develop a behavioral signature for malware detection <ref type="bibr" target="#b6">[7]</ref>.</p><p>Dynamic analysis complements static analysis, and is able to overcome malware code obfuscation. Willems et al. <ref type="bibr" target="#b22">[23]</ref> proposed CWSandbox that combines static and dynamic techniques for analyzing malware on a contained host. Guarnieri et al. <ref type="bibr" target="#b7">[8]</ref>'s Cuckoo sandbox follows similar concepts as CWSandbox and additionally provides a network packet sink. Both works utilize virtual machines to isolate study environment and the host. However, stealthy malware has another set of techniques to evade dynamic analysis -it detects debuggers and virtual machines, which are often used to speed up and facilitate dynamic analysis, and modifies its behavior. This leads to incorrect or unusable signatures of stealthy malware. Chen et al. <ref type="bibr" target="#b3">[4]</ref> found that 39.9% and 2.7% of 6,222 malware samples exhibit anti-debugging and antivirtualization behaviors respectively. In 2012, Branco et al. <ref type="bibr" target="#b2">[3]</ref> analyzed 4 million samples and observed that 81.4% of them exhibited anti-virtualization behavior and 43.21% exhibited anti-debugging behavior.</p><p>Our work helps analyze malware that would otherwise be missed by static and dynamic analysis, because it relies on observations of malware's network behavior. Malware can be run on bare metal machines thus evading detection of the analysis environment.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.3">Dynamic Analysis of Network Behavior</head><p>There are a few efforts on analyzing the semantic of malware network behavior. Sandnet <ref type="bibr" target="#b15">[16]</ref> provided a detailed, statistical analysis of malware network traffic.</p><p>The authors surveyed protocol popularity employed by malware. However, they did not go further to understand the semantic of the network communication, while we do.</p><p>Morales et al.</p><p>[13] studied seven network activities, selected using heuristics. These activities could be used to identify malicious activities. Morales et al. also report on prevalence of those behaviors in contemporary malware. Their chosen activities are not as useful to understand a malware sample's purpose or type, and are very limited. We complement this work by extending the set of activities being observed.</p><p>Nari et al. <ref type="bibr" target="#b13">[14]</ref> proposed an automated malware classification system also focusing on malware network behavior, which generates protocol flow dependency graph based on the IP address being contacted by malware. Our work improves this effort by systematizing detection of different malware behaviors using different network behavior patterns, and different network traffic contents.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">Capturing Malware Network Behavior</head><p>With prevalence of high-speed Internet access, malware has begun to rely more and more on network to achieve its ultimate purpose <ref type="bibr" target="#b8">[9,</ref><ref type="bibr" target="#b19">20]</ref>. Malware often downloads binaries needed for its functionality from the Internet, or connects into command and control channel to receive instructions on its next activity <ref type="bibr" target="#b9">[10]</ref>. Advanced persistent threats <ref type="bibr" target="#b20">[21]</ref> and keyloggers collect sensitive information on users' computers, but need network access to transfer it to the attacker. DDoS attack tools, scanners, spam and phishing malware require network access to send malicious traffic to their targets.</p><p>We propose to study malware's network activities because they have become essential for modern malware. The first step in this study includes capturing malware's network traffic in an environment, which is transparent to malware but also minimizes risk to Internet hosts.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1">Analysis Environment: Fantasm</head><p>In our prior work, we have developed a semi-contained network experiment environment, called Fantasm <ref type="bibr" target="#b5">[6]</ref>. Fantasm runs on a testbed with full Internet access, and carefully constrains this access to achieve productive malware analysis, and minimize risk to outside hosts. In our analysis, we run malware on a bare metal Windows host, without any virtualization or debugger. We capture and analyze all network traffic between this machine and the outside using a separate Linux host, sitting in between the Windows host and the Internet. Both hosts are controlled by our Fantasm framework.</p><p>Fantasm makes decisions on which communications to impersonate, i.e., intercept and answer itself, which to forward and which to drop. This decision is made by taking into account each outgoing flow separately, making an initial decision, and revising it later if subsequent observations require this. We define a flow as a unique combination of destination IP address, destination port and protocol. Each flow is initially regarded as nonessential, and it is dropped. If this leads to the abortion of malware activity, we stop our analysis, restart it, and regard that specific flow as essential. Fantasm then considers if it can fake replies to this outgoing connection in a way that would be indistinguishable from the actual replies, should the flow be allowed into the Internet. If Fantasm has an impersonator for the given destination and the given service, it will intercept the communication and fake the response. Otherwise, it will evaluate if the outgoing flow may be risky to let out. If so, the flow will be dropped. Otherwise, it will be let out into the Internet. <ref type="table">Table 1</ref> illustrates the criteria we use to determine if a flow is risky or not, and if it can be impersonated. Note that even flows considered not risky and let out are still subjected to further monitoring and may be aborted if they misbehave. Flows, which are let out, could become part of scanning or DDoS. To minimize risk of unwitting participation in attacks, we actively monitor for these activities and enforce limits on the number of suspicious flows that a sample can initiate. We define a suspicious flow as a flow, which receives no replies from the Internet. Many scan and DDoS flows will be classified as suspicious. If the analyzed malware sample exceeds its allowance of suspicious flows (10 in our current implementation), we abort its analysis.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1.1">Impersonators</head><p>To handle simple outgoing requests with predictable replies, we built dummy services that can produce these replies within our analysis environments, called impersonators. Several protocols used by popular services are good candidates to be handled by impersonators, such as ICMP, SMTP, and FTP. ICMP_ECHO messages have a Service or Protocol Label DNS, HTTP, HTTPS Not risky FTP, SMTP, ICMP_ECHO Risky, can be impersonated Other services or protocols Risky, cannot be impersonated <ref type="table">Table 1</ref>: Flow policies in Fantasm predictable reply, which can be either positive or negative. Our impersonator provides a positive reply to each ICMP_ECHO request. SMTP actions by malware are usually used for spamming purpose, and require us to only fake a successful receipt. We do this by setting up an Email server, which replies with a "250 OK" message to any request. Our FTP service impersonator is a customized, permissive FTP service, which accepts any user name and password combination.</p><p>In addition to impersonating servers for these three types of traffic, we set up our Fantasm host to act as DNS caching proxy for all DNS requests by malware. This enables us to observe malware's DNS traffic and to cache replies, thus again minimizing outgoing requests.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">High-level Behaviors</head><p>To analyze captured network traces, and reason about malware behavior, we need to impose some structure on trace data. We do this by identifying certain network behavior patterns, which we believe will be commonly used for a given malware purpose. We call these patterns highlevel behaviors. We seek to identify behaviors, which are common for the following malware purposes:</p><p>• Downloading. This type of malware activity is prevalent and usually occurs immediately upon infection, since many malware samples are just empty downloaders to defeat static and dynamic analysis <ref type="bibr" target="#b1">[2]</ref>.</p><p>• Reporting. This type of activity usually suggests that malware samples are submitting information gathered from the victim to their command &amp; control server, as well as requesting more information from it.</p><p>• Scanning. This is usually used to collect vulnerable host identities, to use as potential victims in future attacks.</p><p>• Spamming. Such malware samples send spam emails that usually contain phishing materials like malicious URLs or attachments.</p><p>• C&amp;C communication. Malware samples maintain a connection with certain public services such as IRC to receive C&amp;C commands.</p><p>• Propagating. This type of malware takes advantage of file transfer protocols (e.g. ftp, samba, NFS, etc.) to propagate binaries to other hosts. <ref type="table" target="#tab_1">Table 2</ref> summaries high-level behaviors, which we use to infer the above mentioned malware purposes:</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.1">High-level Behavior Signature</head><p>Fantasm extracts many features from network traces. These features could be used by machine learning to learn how to classify malware behaviors into high-level categories, but this would require manual labeling of many samples. Instead, we can use a simpler set of parameters and behavior patterns to achieve identification of high-level behaviors in a deterministic fashion. We utilize information including protocol, port, packet length, as well as some application level headers. We also observe the sequences of network behaviors to identify patterns that denote a specific high-level behavior. For example, if malware attempts to connect to an external host on port 25, 465 or 587 and send email we will infer that this is part of the "spamming" category. A detailed description of network patterns and parameters we use is shown in <ref type="table" target="#tab_1">Table 2</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5">Experiment and Evaluation</head><p>We now use the patterns identified in the previous section to study prevalence of our selected high-level behaviors in contemporary malware.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.1">Experiment Setup</head><p>Our experiment environment is built using the Fantasm platform <ref type="bibr" target="#b5">[6]</ref>, which allows for safe and productive live malware experimentation. Fantasm is built on the DeterLab testbed <ref type="bibr" target="#b11">[12]</ref>, which is a public testbed for cybersecurity research and education. DeterLab allows users to request a number of physical nodes, connect them into custom network topologies and install custom OS and applications on them. Users are granted root access to the machines in their experiments. Fantasm utilizes this infrastructure to construct a LAN environment with a node running Windows to host the malware, and another node running Ubuntu Linux acting as the gateway.  Fantasm provides necessary services for impersonators, and monitors the network activities by capturing all network packets using tcpdump. One round of analysis for a given malware sample consists of the following steps:</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Action</head><p>• Enable service network monitoring on Linux gateway</p><p>• Reload operating system on Windows node, and set up necessary network configurations</p><p>• Deploy and start the malware binary and continue running it for a given time period (we used 5 minutes)</p><p>• Kill the malware process and save the captured network trace.</p><p>This setting has the advantage that it is immune to current analysis evasion attempts by malware, because it does not use a debugger or a virtual machine. By reloading OS for each run, it ensure that each sample is analyzed in an environment free from any artifacts from the previous analysis rounds.</p><p>The malware samples we used in the study were provided by the Georgia Tech Apiary project <ref type="bibr" target="#b0">[1]</ref>, which is a repository with a daily collection of malware samples. We randomly selected 999 malware captured in Mar. 2016 for this research. Next we submitted each sample to VirusTotal <ref type="bibr" target="#b21">[22]</ref> to determine the type of malware, and ensure that the sample is recognized as malicious. We then analyzed each selected sample in our experiment environment, using the method described above. After the analysis, we have saved traces with all captured communications to and from the Windows node.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.2">Gathering High-Level Behavior</head><p>Our analysis program extracted all useful parameters to identify high-level behavior as described in  <ref type="table">Table 3</ref>: Percentage of our selected 999 malware samples, which exhibit the given high-level behavior. <ref type="table" target="#tab_1">1  67.6%  2</ref> 28.2% 3</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Count of behaviors Ratio</head><p>3.4% 4 0.7% 5 or more 0% <ref type="table">Table 4</ref>: Percentage of malware having the given number of behaviors, among all malware, which exhibited some network activity.</p><p>program first generates raw results for all parameters such as protocol, destination ports, HTTP request type, remote hosts, as well as session sequence patterns. We then automatically identify patterns listed in <ref type="table" target="#tab_1">Table 2</ref>, to detect high-level behaviors. Our results are shown in <ref type="table">Ta- ble 3 and Table 4</ref>. <ref type="table">Table 3</ref> shows prevalence of different behaviors in our malware samples. Around 57% of the samples do not show any network activity. Possible reasons of inactivity include shortness of the observation period, malware waiting for an external trigger, or outdated (dormant) malware. We plan to establish the exact causes of inactivity in our future work.</p><p>Out of malware samples, which exhibit some network  We were further interested in combinations of behaviors, which show up together. <ref type="table">Table 4</ref> shows the percentage of samples, which show one or more behavior. More than 30% of the samples, which exhibit some network activity, engage in more than one behavior, and around 4% of the samples engage in more than two behaviors. <ref type="table" target="#tab_4">Table 5</ref> shows the most common behavior combinations. Scanning and propagating show up most frequently together (43.1%), which is not surprising. This combination suggests that most propagating malware samples are also equipped with scanning capability to find potential victims. The next common combination is downloading with propagating, which suggests this kind of malware samples usually download new payload, and then propagate further. Also frequent is scanning with spamming, suggesting spam malware samples also scan for potential victims, before sending spam.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6">Discussion and Future Work</head><p>Currently we have defined patterns, which we can be used to detect six types of high-level behaviors. We believe there are more high-level behaviors that are useful for understanding malware, and we will seek to define them (and the associated patterns) in our future work.</p><p>Our experiment results also suggest that behavior combinations are common. We believe this finding can be useful for the following future directions in malware analysis.</p><p>Malware detection. Most low-level malware behaviors also occur in benign software, which makes them unreliable for malware detection purposes. However, combinations of these low-level behaviors may be unique to malware, and could be useful for detection. For example, a software that scans other hosts and then copies data over is unlikely to be benign, although each of these actions separately could be undertaken by benign software (e.g., probing several servers could look like scanning, if servers are unresponsive, and data can be uploaded to a cloud for legitimate reasons) As we extend our malware analysis to more samples, we expect to find more behavior combinations, which can be used for malware detection.</p><p>Polymorphic malware. Modern malware may take advantage of a polymorphic engine to encode itself and evade signature-based detection. Through network behavior analysis and behavior combination patterns, we may detect similar malicious behaviors exhibited by different binary samples. These samples could be polymorphic versions of the same code. Thus our work can be useful to detect polymorphic malware.</p><p>Malware genealogy. With longer analysis on more samples, we hope to build a more fine-grained representation of high-level malware behaviors. Such information can then be used identify malware samples, which have similar behaviors, and thus may be related. For example, if two samples send emails with the same attachments, use same or similar phishing URLs or contact the same C&amp;C server, they are likely to be related. Similarly, if two samples exhibit similar spamming behavior (e.g., using same or similar content) but one has self-propagating behavior too, while the other does not, these samples are likely to be related. Our high-level behaviors can be useful to study malware genealogy and to identify malware families. Similarly, when malware downloads a new binary, which then attempts to perform some malicious activity, these two samples work in collaboration for a common goal. We hope to leverage our current work to build information on such related malware in the future.</p><p>Malware Evading Network Analysis. With the existence of techniques to evade signature-based malware detection, we can naturally assume that malware designers will also look to evade our network-communicationbased analysis. There are several strategies that malware could use:</p><p>(a) appear to be dormant and await a specific trigger (b) interleave malicious activities with benign traffic (c) attempt to detect analysis environment, e.g., by attempting to connect to an FTP server with nonexisting username and password (this will succeed in our analysis but fail in real world)</p><p>We leave handling of these evasion techniques for our future work, but sketch some possible solutions here. For trigger-based malware, we could leverage existing work on trigger detection, such as using static analysis and symbolic execution <ref type="bibr" target="#b4">[5]</ref> . For malware, which interleaves its malicious behavior with benign ones, we need to improve our pattern detection to consider subsets of activities, and not just sequences. For malware, which detects our impersonators, we plan to make our impersonators more sophisticated and harder to detect. There is however a trade-off here between impersonator sophistication and scalability. For example, our FTP impersonator could check for each username/password input, if this input can be used to access the actual FTP server in the real Internet. This information could be cached for the next attempt with the same input. Such approach would guarantee that our impersonator always provides correct reply to malware, but it would inundate us with testing and caching potentially many username/password combinations. This approach clearly does not scale. In our future work we will investigate where to draw the line between trying to improve sophistication and stealthiness of our impersonators, and scalability.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="7">Conclusion</head><p>In this work we propose patterns of malware's network behaviors, which can be used to identify some high-level behaviors, such as scanning or spamming. We then study prevalence of these high-level behaviors in contemporary malware. We find that scanning, propagation and downloading are the most prevalent behaviors. We also find the some behavior combinations are quite popular, such as scanning and propagating, downloading and propagating, and scanning and spamming. We discuss how our identification of high-level behaviors could be useful for malware detection, identification of polymorphic malware and identification of malware samples, which may be versions of each other, or share some common code.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="8">Acknowledgments</head><p>This project is the result of funding provided by the Science and Technology Directorate of the United States Department of Homeland Security under contract number HSHQDC-16-C-00024. The views and conclusions contained herein are those of the authors and should not be interpreted necessarily representing the official policies or endorsements, either expressed or implied, of the Department of Homeland Security or the US Government.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Figure 1 :</head><label>1</label><figDesc>Figure 1: Flow handling: how we decide if an outgoing flow will be let out, impersonated or dropped.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_1" validated="false"><head>Table 2 : High-level behavior list.</head><label>2</label><figDesc></figDesc><table></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_2" validated="true"><head>Table 2 . The</head><label>2</label><figDesc></figDesc><table>Behavior 
Percentage 
Downloading 
10.9% 
Reporting 
5.6% 
Scanning 
28.5% 
Spamming 
2.2% 
C&amp;C communication 
0.2% 
Propagating 
11.5% 
Not Detected 
57% 

</table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_4" validated="false"><head>Table 5 :</head><label>5</label><figDesc></figDesc><table>Percentage of malware exhibiting given combinations of behaviors. 

activity, 28.5% engage in scanning scanning, 11.5% in 
propagating itself further and 10.9% in downloading new 
binaries. This suggests that most malware focuses on 
finding vulnerable hosts, downloading the actual mali-
cious code and propagating further. Reporting shows up 
in 5.6% of the samples, while spamming shows up in 
2.2% of the samples. Other types of behaviors, such as 
C&amp;C communication, are rarely seen, which suggests we 
may need more samples or longer observations, to study 
these behaviors. 
</table></figure>
		</body>
		<back>
			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Apiary</surname></persName>
		</author>
		<ptr target="http://apiary.gtri.gatech.edu/.Accessed" />
		<imprint>
			<biblScope unit="page" from="2018" to="2023" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b1">
	<monogr>
		<title level="m" type="main">Effectiveness of antivirus in detecting metasploit payloads. SANS Institute</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Baggett</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<monogr>
		<title level="m" type="main">Scientific but not academical overview of malware antidebugging, anti-disassembly and anti-vm technologies</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><forename type="middle">R</forename><surname>Branco</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">G</forename><forename type="middle">N</forename><surname>Barbosa</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><forename type="middle">D</forename><surname>Neto</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2012" />
			<publisher>Black Hat</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b3">
	<analytic>
		<title level="a" type="main">Towards an understanding of antivirtualization and anti-debugging behavior in modern malware</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">X</forename><surname>Chen</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Andersen</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Z</forename><forename type="middle">M</forename><surname>Mao</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Bailey</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Nazario</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Dependable Systems and Networks With FTCS and DCC</title>
		<imprint>
			<publisher>IEEE</publisher>
			<date type="published" when="2008" />
			<biblScope unit="page" from="177" to="186" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b4">
	<analytic>
		<title level="a" type="main">Static analysis of executables to detect malicious patterns</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Christodorescu</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Jha</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">; Wisconsin Univ-Madison Dept</forename><surname>Of</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">COMPUTER SCIENCES</title>
		<imprint>
			<date type="published" when="2006" />
		</imprint>
	</monogr>
<note type="report_type">Technical report</note>
</biblStruct>

<biblStruct xml:id="b5">
	<monogr>
		<title level="m" type="main">Understanding malware&apos;s network behaviors using fantasm. Proceedings of LASER 2017 Learning from Authoritative Security Experiment Results</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">X</forename><surname>Deng</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">H</forename><surname>Shi</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Mirkovic</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2017" />
			<biblScope unit="page">1</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b6">
	<analytic>
		<title level="a" type="main">A survey on automated dynamic malware-analysis techniques and tools</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Egele</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><surname>Scholte</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">E</forename><surname>Kirda</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><surname>Kruegel</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">ACM computing surveys (CSUR)</title>
		<imprint>
			<biblScope unit="volume">44</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page">6</biblScope>
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b7">
	<monogr>
		<title level="m" type="main">The cuckoo sandbox</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><surname>Guarnieri</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Tanasi</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Bremer</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Schloesser</surname></persName>
		</author>
		<imprint/>
	</monogr>
</biblStruct>

<biblStruct xml:id="b8">
	<analytic>
		<title level="a" type="main">Learning more about the underground economy: A casestudy of keyloggers and dropzones</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><surname>Holz</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Engelberth</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">F</forename><surname>Freiling</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">European Symposium on Research in Computer Security</title>
		<imprint>
			<publisher>Springer</publisher>
			<date type="published" when="2009" />
			<biblScope unit="page" from="1" to="18" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b9">
	<analytic>
		<title level="a" type="main">Framing dependencies introduced by underground commoditization</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">K</forename><forename type="middle">T D Y</forename><surname>Huang</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><forename type="middle">W E B C</forename><surname>Grierd</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><forename type="middle">J</forename><surname>Holt</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><surname>Kruegel</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><surname>Mccoy</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Savage</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">G</forename><surname>Vigna</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Workshop on the Economics of Information Security</title>
		<imprint>
			<date type="published" when="2015" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b10">
	<analytic>
		<title level="a" type="main">Detecting malicious code by model checking</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Kinder</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Katzenbeisser</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><surname>Schallhart</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">H</forename><surname>Veith</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">International Conference on Detection of Intrusions and Malware, and Vulnerability Assessment</title>
		<imprint>
			<publisher>Springer</publisher>
			<date type="published" when="2005" />
			<biblScope unit="page" from="174" to="187" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b11">
	<analytic>
		<title level="a" type="main">Deterlab testbed for cybersecurity research and education</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Mirkovic</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><surname>Benzel</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of Computing Sciences in Colleges</title>
		<imprint>
			<biblScope unit="volume">28</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="163" to="163" />
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b12">
	<analytic>
		<title level="a" type="main">Analyzing and exploiting network behaviors of malware</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><forename type="middle">A</forename><surname>Morales</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Al-Bataineh</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Xu</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Sandhu</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">International Conference on Security and Privacy in Communication Systems</title>
		<imprint>
			<publisher>Springer</publisher>
			<date type="published" when="2010" />
			<biblScope unit="page" from="20" to="34" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b13">
	<analytic>
		<title level="a" type="main">Automated malware classification based on network behavior</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Nari</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><forename type="middle">A</forename><surname>Ghorbani</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Computing, Networking and Communications (ICNC), 2013 International Conference on</title>
		<imprint>
			<publisher>IEEE</publisher>
			<date type="published" when="2013" />
			<biblScope unit="page" from="642" to="647" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b14">
	<analytic>
		<title level="a" type="main">Camouflage in malware: from encryption to metamorphism</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">B</forename><forename type="middle">B</forename><surname>Rad</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Masrom</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Ibrahim</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">International Journal of Computer Science and Network Security</title>
		<imprint>
			<biblScope unit="volume">12</biblScope>
			<biblScope unit="issue">8</biblScope>
			<biblScope unit="page" from="74" to="83" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b15">
	<analytic>
		<title level="a" type="main">Sandnet: Network traffic analysis of malicious software</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><surname>Rossow</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><forename type="middle">J</forename><surname>Dietrich</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">H</forename><surname>Bos</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><surname>Cavallaro</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Van Steen</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">F</forename><forename type="middle">C</forename><surname>Freiling</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">N</forename><surname>Pohlmann</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the First Workshop on Building Analysis Datasets and Gathering Experience Returns for Security</title>
		<meeting>the First Workshop on Building Analysis Datasets and Gathering Experience Returns for Security</meeting>
		<imprint>
			<publisher>ACM</publisher>
			<date type="published" when="2011" />
			<biblScope unit="page" from="78" to="88" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b16">
	<monogr>
		<title level="m" type="main">Evolution and detection of polymorphic and metamorphic malwares: A survey</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Sharma</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><forename type="middle">K</forename><surname>Sahay</surname></persName>
		</author>
		<idno type="arXiv">arXiv:1406.7061</idno>
		<imprint>
			<date type="published" when="2014" />
		</imprint>
	</monogr>
<note type="report_type">arXiv preprint</note>
</biblStruct>

<biblStruct xml:id="b17">
	<analytic>
		<title level="a" type="main">Cardinal pill testing of system virtual machines</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">H</forename><surname>Shi</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Alwabel</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Mirkovic</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">USENIX Security Symposium</title>
		<imprint>
			<date type="published" when="2014" />
			<biblScope unit="page" from="271" to="285" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b18">
	<analytic>
		<title level="a" type="main">Hiding debuggers from malware with apate</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">H</forename><surname>Shi</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Mirkovic</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the Symposium on Applied Computing</title>
		<meeting>the Symposium on Applied Computing</meeting>
		<imprint>
			<publisher>ACM</publisher>
			<date type="published" when="2017" />
			<biblScope unit="page" from="1703" to="1710" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b19">
	<analytic>
		<title level="a" type="main">The underground economy of spam: A botmaster&apos;s perspective of coordinating large-scale spam campaigns</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">B</forename><surname>Stone-Gross</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><surname>Holz</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">G</forename><surname>Stringhini</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">G</forename><surname>Vigna</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">LEET</title>
		<imprint>
			<biblScope unit="volume">11</biblScope>
			<biblScope unit="page" from="4" to="4" />
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b20">
	<analytic>
		<title level="a" type="main">Advanced persistent threats and how to monitor and deter them</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><surname>Tankard</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Network security</title>
		<imprint>
			<biblScope unit="issue">8</biblScope>
			<biblScope unit="page" from="16" to="19" />
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b21">
	<monogr>
		<title level="m" type="main">Virustotal-free online virus, malware and url scanner</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Virustotal</surname></persName>
		</author>
		<ptr target="https://www.virustotal.com/en" />
		<imprint>
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b22">
	<analytic>
		<title level="a" type="main">Toward automated dynamic malware analysis using cwsandbox</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><surname>Willems</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><surname>Holz</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">F</forename><surname>Freiling</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Security &amp; Privacy</title>
		<imprint>
			<biblScope unit="volume">5</biblScope>
			<biblScope unit="issue">2</biblScope>
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b23">
	<analytic>
		<title level="a" type="main">Malware obfuscation techniques: A brief survey</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">I</forename><surname>You</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">K</forename><surname>Yim</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Broadband, Wireless Computing, Communication and Applications (BWCCA), 2010 International Conference on</title>
		<imprint>
			<publisher>IEEE</publisher>
			<date type="published" when="2010" />
			<biblScope unit="page" from="297" to="300" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
